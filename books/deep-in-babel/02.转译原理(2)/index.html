<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>语法分析和语义分析 | 《深入理解 Babel》 · 刘远洋</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="manifest" href="/books/deep-in-babel/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="Deep In Babel">
    <meta property="og:url" content="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/">
    <meta property="og:site_name" content="《深入理解 Babel》 · 刘远洋">
    <meta property="og:title" content="语法分析和语义分析">
    <meta property="og:description" content="语法分析和语义分析 语法分析（syntactic analysis）的作用是在词法分析的基础上，遍历 token，从而识别出程序的抽象语法树（AST），它是一个树形结构。这个树形结构主要描述了源码的结构，暂时还缺少语义信息，比如作用域、类型检查等，我们将在语义分析的环节详细介绍。 以英文句子 &quot;today is comfortable.&quot; 为例，对其词法分析">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="《深入理解 Babel》 · 刘远洋">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/books/deep-in-babel/assets/css/0.styles.33c62197.css" as="style"><link rel="preload" href="/books/deep-in-babel/assets/js/app.6c526340.js" as="script"><link rel="preload" href="/books/deep-in-babel/assets/js/vendors~layout-Layout.9baf7bd4.js" as="script"><link rel="preload" href="/books/deep-in-babel/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.ebefd1c7.js" as="script"><link rel="preload" href="/books/deep-in-babel/assets/js/page-语法分析和语义分析.23eb0004.js" as="script"><link rel="preload" href="/books/deep-in-babel/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.33005620.js" as="script"><link rel="prefetch" href="/books/deep-in-babel/assets/js/24.7771afa6.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/layout-Blog.b0c6dcb7.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/layout-Layout.54347a9b.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/layout-NotFound.846facba.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/layout-Slide.88fa1023.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--340e5eca.aefecb9a.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--4c0dc106.843e4126.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--4fdeacc4.e552a9df.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--6723acaa.da12b506.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--67cf3cc0.cb47bcf4.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--6b62a710.642cab91.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--8fcba694.9bb51ce1.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--9bf3e428.cd5ab0a9.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--aec4dcea.559a970f.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--c3b426fa.80240255.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page--d99aed8e.d8d65af8.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page-623提案特性转换插件.09ecfcd6.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/page-前言.77876ee7.js"><link rel="prefetch" href="/books/deep-in-babel/assets/js/vendors~photo-swipe.afe47db0.js">
    <link rel="stylesheet" href="/books/deep-in-babel/assets/css/0.styles.33c62197.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/books/deep-in-babel/" class="home-link router-link-active"><!----> <!----> <span class="site-name can-hide">《深入理解 Babel》 · 刘远洋</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://notelyio.com/home" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Notely 编写
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hoperyy" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  hoperyy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hoperyy/deep-in-babel" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  deep-in-babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="https://notelyio.com/home" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Notely 编写
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hoperyy" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  hoperyy
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/hoperyy/deep-in-babel" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  deep-in-babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/books/deep-in-babel/00.%E5%89%8D%E8%A8%80/" class="sidebar-link">第 0 章 - 前言</a></li><li><a href="/books/deep-in-babel/01.%E6%A6%82%E8%BF%B0/" class="sidebar-link">第 1 章 - 概述</a></li><li><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(1)/" class="sidebar-link">第 2 章 - 转译原理 (1)</a></li><li><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/" aria-current="page" class="active sidebar-link">第 2 章 - 转译原理 (2)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#语法分析和语义分析" class="sidebar-link">语法分析和语义分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#相关概念" class="sidebar-link heading3">相关概念</a></li><li class="sidebar-sub-header"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#语法分析和语义分析过程" class="sidebar-link heading3">语法分析和语义分析过程</a></li><li class="sidebar-sub-header"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#babel-的语法分析和语义分析" class="sidebar-link heading3">Babel 的语法分析和语义分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/books/deep-in-babel/03.Babel%E8%8A%82%E7%82%B9/" class="sidebar-link">第 3 章 - Babel 节点</a></li><li><a href="/books/deep-in-babel/04.Babel%E5%B7%A5%E5%85%B7%E9%9B%86/" class="sidebar-link">第 4 章 - Babel 工具集</a></li><li><a href="/books/deep-in-babel/05.Babel%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/" class="sidebar-link">第 5 章 - Babel 插件编写</a></li><li><a href="/books/deep-in-babel/06.Babel%E5%86%85%E7%BD%AEPlugin(1)/" class="sidebar-link">第 6 章 - Babel 内置 Plugin (1)</a></li><li><a href="/books/deep-in-babel/06.Babel%E5%86%85%E7%BD%AEPlugin(2)/" class="sidebar-link">第 6 章 - Babel 内置 Plugin (2)</a></li><li><a href="/books/deep-in-babel/07.Babel%E5%86%85%E7%BD%AEPreset/" class="sidebar-link">第 7 章 - Babel 内置 Preset</a></li><li><a href="/books/deep-in-babel/08.runtime/" class="sidebar-link">第 8 章 - runtime</a></li><li><a href="/books/deep-in-babel/09.Babel%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/" class="sidebar-link">第 9 章 - Babel 项目管理</a></li><li><a href="/books/deep-in-babel/10.%E8%BD%AC%E8%AF%91%E5%99%A8%E5%AF%B9%E6%AF%94/" class="sidebar-link">第 10 章 - 转译器对比</a></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">语法分析和语义分析</span></h1> <div class="page-info"><!----> <!----><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2022-6-2</span></span><!----><!----><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 43 min</span> <meta property="timeRequired" content="PT43M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#语法分析和语义分析" class="anchor-link heading2"><div>语法分析和语义分析</div></a></li><li class="anchor"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#相关概念" class="anchor-link heading3"><div>相关概念</div></a></li><li class="anchor"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#语法分析和语义分析过程" class="anchor-link heading3"><div>语法分析和语义分析过程</div></a></li><li class="anchor"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#babel-的语法分析和语义分析" class="anchor-link heading3"><div>Babel 的语法分析和语义分析</div></a></li><li class="anchor"><a href="/books/deep-in-babel/02.%E8%BD%AC%E8%AF%91%E5%8E%9F%E7%90%86(2)/#总结" class="anchor-link heading2"><div>总结</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="语法分析和语义分析"><a href="#语法分析和语义分析" class="header-anchor">#</a> 语法分析和语义分析</h2> <p>语法分析（syntactic analysis）的作用是在词法分析的基础上，遍历 token，从而识别出程序的抽象语法树（AST），它是一个树形结构。这个树形结构主要描述了源码的结构，暂时还缺少语义信息，比如作用域、类型检查等，我们将在语义分析的环节详细介绍。</p> <p>以英文句子 <code>&quot;today is comfortable.&quot;</code> 为例，对其词法分析就是将句子分离为各个单词，而语法分析关注的是单词和单词之间的关系，这些关系就是所谓的语法。</p> <p>https://www.tr0y.wang/2021/04/04/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9A%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90/</p> <p>语义分析负责分析上下文相关的情况，和具体语言相关。</p> <h3 id="相关概念"><a href="#相关概念" class="header-anchor">#</a> 相关概念</h3> <h4 id="抽象语法树和具象语法树"><a href="#抽象语法树和具象语法树" class="header-anchor">#</a> 抽象语法树和具象语法树</h4> <ul><li><p>具象语法树（concrete syntax tree, CST）</p> <p>具象语法树（concrete syntax tree, CST），又称为语法树（syntax tree），它是源码的树状表示，会展示各种语法细节。</p> <p>TODO（画图）</p></li> <li><p>抽象语法树（abstract syntax tree, AST）</p> <p>抽象语法树也是树形结构，只不过相对于具象语法树，其不会展示源码的各种语法细节。</p> <p>TODO（画图）</p></li> <li><p>不同点</p> <ul><li><p>AST 使用操作符作为根节点和内部节点，并用操作数作为子节点</p> <p>TODO（画图）</p></li> <li><p>与 CST 不同，AST 不适用内部节点表示语法规则</p> <p>TODO（画图）</p></li> <li><p>AST 不代表真实语法的每个细节，比如，它省略了括号等细节</p> <p>TODO（画图）</p></li> <li><p>与 CST 相比，AST 更密集</p> <p>TODO（画图）</p></li></ul></li> <li><p>案例</p> <p>TODO（画图）</p></li></ul> <h4 id="语法分析器"><a href="#语法分析器" class="header-anchor">#</a> 语法分析器</h4> <p>语法分析器负责接收 token 列表，生成源码的抽象语法树，此时的抽象语法树，重点在描述源码的程序结构信息。</p> <h4 id="上下文无关文法"><a href="#上下文无关文法" class="header-anchor">#</a> 上下文无关文法</h4> <ul><li><p>文法</p> <p>以英文句子 <code>&quot;today is comfortable.&quot;</code> 为例，文法用于定义该句子的结构，对于编程语言，文法用户定义编程语言的结构。</p></li> <li><p>乔姆斯基文法体系</p> <p>一位叫乔姆斯基的教授准备利用数学来研究人类自然语言的规律，在此期间，他总结了很多数学工具和方法，称为&quot;乔姆斯基文法体系&quot;。但这套体系在计算机领域进行了发扬光大，用于对程序语言进行结构分析。</p> <p>乔姆斯基文法体系有4类文法:</p> <ul><li>0 型文法: 任意文法，在程序设计语言中不常用</li> <li>1 型文法: 上下文相关文法，在程序设计语言中不常用</li> <li>2 型文法: 上下文无关文法（Context-free Grammar，CFG）在程序设计中用于描述程序语言的语法结构</li> <li>3 型文法: 正则文法，就是词法分析中的正则表达式，可以用来描述程序语言的词法结构</li></ul> <p>所有文法中，0 型文法的表达能力最强，3 型文法最弱，如图:</p> <p>TODO（画图）</p></li> <li><p>上下文无关文法（Context-free Grammar，CFG）</p> <p>下文无关文法，指的是该文法定义的所有句子结构之间是没有任何关系的，比如 <code>ID = ID + ID</code>，我们不需要关注 <code>ID</code> 是怎么来的，上下文有什么和它有关的内容，我们只需要关心一个字符是否是 <code>ID</code>，并且 <code>ID</code> 的等价形式是什么。</p> <p>https://www.cnblogs.com/jacksplwxy/p/10052752.html</p> <p>一个上下文无关文法包括四个部分: 终结符号集合，非终结符号集合，起始符号，产生式集合。</p></li> <li><p>用上下文无关文法描述算术表达式</p> <p>TODO</p></li></ul> <h4 id="生成-ast-的算法"><a href="#生成-ast-的算法" class="header-anchor">#</a> 生成 AST 的算法</h4> <p>有两种方式可以生成 AST: 自顶向下分析、自底向上分析。</p> <ul><li><p>自顶向下分析</p> <p>在自顶向下分析中，&quot;递归下降&quot;算法是常用的一种算法，&quot;递归下降&quot;算法包括两个要点: &quot;下降&quot;和&quot;递归&quot;。</p> <ul><li><p>下降</p></li> <li><p>递归</p></li> <li><p>左递归</p></li></ul></li> <li><p>自底向上分析</p> <p>TODO</p> <ul><li>自顶向下分析: 根据形式语法规则，在语法分析树的自顶向下展开中搜索输入符号串可能的最左推导。单词按从左到右的顺序依次使用。</li> <li>自底向上分析: 语法分析器从现有的输入符号串开始，尝试将其根据给定的形式语法规则进行改写，最终改写为语法的起始符号。</li></ul></li></ul> <h4 id="引用消解"><a href="#引用消解" class="header-anchor">#</a> 引用消解</h4> <p>引用消解解决的是如何找到引用的定义的问题。比如下述案例:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span><span class="token operator">&gt;</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">2</span><span class="token operator">&gt;</span>
<span class="token number">3</span><span class="token operator">&gt;</span> <span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token number">4</span><span class="token operator">&gt;</span>     <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token number">5</span><span class="token operator">&gt;</span>     <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token number">6</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token number">7</span><span class="token operator">&gt;</span> 
<span class="token number">8</span><span class="token operator">&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>在外层环境和 <code>run()</code> 内部都定义了变量 <code>a</code>，无论是编辑器快速跳到 <code>a</code> 变量的定义，还是在运行时，都能准确发现第五行的变量 <code>a</code> 的值是第四行的 <code>2</code>。这个发现定义的过程就是引用消解。</p> <h4 id="左值和右值"><a href="#左值和右值" class="header-anchor">#</a> 左值和右值</h4> <p>左值和右值是开发编译器、解释器时绕不开的一个话题，什么是左值和右值呢？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>a <span class="token operator">+</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面这个例子中，很显然取的是变量 <code>a</code> 的值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>a <span class="token operator">=</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个例子中，取的是变量 <code>a</code> 的地址，并将 <code>5</code> 赋值到该地址对应的值中，当然这部分是 JavaScript 内部的处理。</p> <p>对于 Babel 这样的转译器而言，需要区分源码中，哪些属于赋值操作，哪些属于取值操作。</p> <p>简单而言，左值指的就是赋值的目标，右值指的就是取值的目标。</p> <p>满足左值，自然要满足一些条件:</p> <ul><li>节点位于赋值表达式的左边</li> <li>节点位于函数的形参</li> <li>一元操作符: <code>++</code> 或 <code>--</code></li> <li>其他需要改变变量值的情况</li></ul> <p>对于像 <code>a + 3</code>、<code>a = 5</code> 这样的代码，对应到语法树上，都叫做 <code>xxxx</code> 节点，那么用什么方式区分它们是左值还是右值呢，就需要在 <code>xxxx</code> 节点上添加一些属性进行标记。</p> <p>获取这些标记属性的过程，叫&quot;属性计算&quot;。</p> <h4 id="属性计算"><a href="#属性计算" class="header-anchor">#</a> 属性计算</h4> <ul><li><p>属性文法</p> <p>在词法分析中涉及到了正则文法，在语法分析中涉及到了上下文无关文法。而在语义分析中，涉及到了属性文法。</p> <p>属性文法计算的是语义分析中，某个节点的上下文信息，比如某个节点的值（<code>value</code>）就是一种典型的属性计算。</p> <p>用语法分析中涉及的上下文无关文法来描述加法计算，描述如下:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>add → add <span class="token operator">+</span> mul
add → mul
mul → mul <span class="token operator">*</span> primary
mul → primary
primary → <span class="token string">&quot;(&quot;</span> add <span class="token string">&quot;)&quot;</span>
primary → integer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在上述上下文无关文法的描述基础上，针对节点的 <code>value</code> 属性，用属性文法描述如下:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>dd1 → add1 <span class="token operator">+</span> mul <span class="token punctuation">[</span> add1<span class="token punctuation">.</span>value <span class="token operator">=</span> add2<span class="token punctuation">.</span>value <span class="token operator">+</span> mul<span class="token punctuation">.</span>value <span class="token punctuation">]</span>
add → mul <span class="token punctuation">[</span> add<span class="token punctuation">.</span>value <span class="token operator">=</span> mul<span class="token punctuation">.</span>value <span class="token punctuation">]</span>
mul1 → mul2 <span class="token operator">*</span> primary <span class="token punctuation">[</span> mul1<span class="token punctuation">.</span>value <span class="token operator">=</span> mul2<span class="token punctuation">.</span>value <span class="token operator">*</span> primary<span class="token punctuation">.</span>value <span class="token punctuation">]</span>
mul → primary <span class="token punctuation">[</span> mul<span class="token punctuation">.</span>value <span class="token operator">=</span> primary<span class="token punctuation">.</span>value <span class="token punctuation">]</span>
primary → <span class="token string">&quot;(&quot;</span> add <span class="token string">&quot;)&quot;</span> <span class="token punctuation">[</span> primary<span class="token punctuation">.</span>value <span class="token operator">=</span> add<span class="token punctuation">.</span>value <span class="token punctuation">]</span>
primary → integer <span class="token punctuation">[</span> primary<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">strToInt</span><span class="token punctuation">(</span>integer<span class="token punctuation">.</span>str<span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这就是属性文法定义的针对 <code>value</code> 的规则，规则确定后，就能通过工具计算出该属性的值。</p> <p>这种属性文法定义的规则，叫做语法制导的定义（Syntax directed definition，SDD），如果变成计算动作，就叫做语法制导的翻译（Syntax directed translation，SDT）。</p></li> <li><p>综合属性和继承属性</p> <ul><li><p>综合属性（S 属性，Synthesized Attribute）</p> <p>如果一种属性能够由下级节点推导出来，那么这种属性就叫 S 属性（Synthesized Attribute），也就是综合属性，能够从下级节点的属性归纳、计算为本节点的属性。</p> <p>比如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>a <span class="token operator">=</span> <span class="token string">'1'</span> <span class="token operator">+</span> <span class="token number">2</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在语义分析阶段，Babel 等转译器已经可以知道变量 <code>a</code> 的类型是 <code>string</code> 了，而这个类型是由&quot;类型推导&quot;而来，变量 <code>a</code> 的类型由其两个子节点（字符串 <code>'1'</code> 和数字 <code>2</code> ）决定，这两个子节点的类型推导出了 <code>a</code> 的类型。</p></li> <li><p>继承属性（I属性，Inherited Attribute）</p> <p>与S属性相对应，I属性（Inherited Attribute）意为继承属性，它可以通过当前节点的上级节点、兄弟节点、自身节点来决定。</p> <p>TODO</p></li></ul></li> <li><p>属性计算的时机</p> <p>属性计算逻辑上位于语义分析环节，但是在实际编译逻辑执行中，进行语法分析生成AST的同时，属性计算等语义分析也可以同步进行。</p> <p>比如，在语法分析的时候，如果某个节点的属性可以通过其他节点（父节点、兄弟节点）计算而来，那么该属性可以在构建 AST 的时候顺便执行了计算。</p> <p>另外，语法分析生成 AST 后，语义分析可以根据需要，对 AST 进行多次遍历，为其进行不同的属性计算。</p></li> <li><p>属性计算在语义分析中的应用</p> <ul><li>作用域解析</li> <li>引用消解</li> <li>类型推导</li> <li>类型检查</li> <li>类型转换</li> <li>语义合法性检查</li></ul></li></ul> <h3 id="语法分析和语义分析过程"><a href="#语法分析和语义分析过程" class="header-anchor">#</a> 语法分析和语义分析过程</h3> <h4 id="第1步-确定文法规则"><a href="#第1步-确定文法规则" class="header-anchor">#</a> 第1步: 确定文法规则</h4> <p>TODO</p> <h4 id="第2步-自顶向下分析"><a href="#第2步-自顶向下分析" class="header-anchor">#</a> 第2步: 自顶向下分析</h4> <p>TODO</p> <h3 id="babel-的语法分析和语义分析"><a href="#babel-的语法分析和语义分析" class="header-anchor">#</a> Babel 的语法分析和语义分析</h3> <p>语法分析的目的是生成源码的结构化表示，即抽象语法树（AST），此时并不需要特别关注语义方面的问题，专注生成 AST。</p> <h4 id="源码结构"><a href="#源码结构" class="header-anchor">#</a> 源码结构</h4> <p>文件 <code>babel/packages/babel-parser/src/parser/index.js</code> 既包含了词法分析模块，也包含了语法和语义分析模块。其定义了 <code>Parser</code> 类，在内部实现上有一系列的继承关系:</p> <table><thead><tr><th>继承顺序</th> <th>作用</th></tr></thead> <tbody><tr><td><code>Parser</code></td> <td>对外提供语法分析能力</td></tr> <tr><td><code>StatementParser</code></td> <td>解析声明</td></tr> <tr><td><code>ExpressionParser</code></td> <td>解析表达式</td></tr> <tr><td><code>LValParser</code></td> <td>解析左值</td></tr> <tr><td><code>NodeUtils</code></td> <td>AST节点的各种属性和方法</td></tr> <tr><td><code>UtilParser</code></td> <td></td></tr> <tr><td><code>Tokenizer</code></td> <td>词法分析器</td></tr> <tr><td><code>ParserErrors</code></td> <td>错误处理模块</td></tr> <tr><td><code>CommentsParser</code></td> <td>对注释进行解析</td></tr> <tr><td><code>BaseParser</code></td> <td>提供基础属性和关于插件的工具方法</td></tr></tbody></table> <p>通过观察 Babel Parser 中的继承链，我们也可以了解完整的语法分析可以分解为哪些模块。</p> <p>这里先介绍一些基础模块的功能，如 <code>BaseParser/ErrorParser</code>，其他模块将在介绍 Babel 的语法分析、语义分析时分别详细介绍。</p> <h5 id="baseparser"><a href="#baseparser" class="header-anchor">#</a> <code>BaseParser</code></h5> <p><code>BaseParser</code> 类作为继承链的基础类，提供了一些基础属性和方法，为继承链的其他类使用。</p> <p>由此可以看出，&quot;继承链&quot;也是一种良好的代码复用的方式。</p> <p><code>BaseParser</code> 定义了一些属性和方法。</p> <ul><li><p>属性</p> <ul><li><p><code>options</code></p> <p><code>babel-parser</code> 对外暴露方法的配置项，参数类型定义在 <code>babel/packages/babel-parser/src/options.js</code>。</p> <ul><li><p><code>sourceType</code>: <code>SourceType</code></p></li> <li><p><code>sourceFilename</code>: <code>string</code></p></li> <li><p><code>startLine</code>: <code>number</code></p></li> <li><p><code>allowAwaitOutsideFunction</code>: <code>boolean</code></p></li> <li><p><code>allowReturnOutsideFunction</code>: <code>boolean</code></p></li> <li><p><code>allowImportExportEverywhere</code>: <code>boolean</code></p></li> <li><p><code>allowSuperOutsideMethod</code>: <code>boolean</code></p></li> <li><p><code>plugins</code>: <code>PluginList</code></p></li> <li><p><code>strictMode</code>: <code>boolean</code></p></li> <li><p><code>ranges</code>: <code>boolean</code></p></li> <li><p><code>tokens</code>: <code>boolean</code></p></li> <li><p><code>createParenthesizedExpressions</code>: <code>boolean</code></p></li> <li><p><code>errorRecovery</code>: <code>boolean</code></p></li></ul></li> <li><p><code>inModule</code></p></li> <li><p><code>scope</code></p></li> <li><p><code>classScope</code></p></li> <li><p><code>expressionScope</code></p></li> <li><p><code>prodParam</code></p></li> <li><p><code>plugins</code></p></li> <li><p><code>filename</code></p></li> <li><p><code>exportedIdentifiers</code></p></li> <li><p><code>sawUnambiguousESM</code></p></li> <li><p><code>ambiguousScriptDifferentAst</code></p></li> <li><p><code>state</code></p></li> <li><p><code>input</code></p></li> <li><p><code>length</code></p> <p>用于获取 <code>input</code> 的长度，因为 <code>input</code> 会比较长，考虑到性能优化，要获取其长度，Babel 会尽量避免直接获取其长度，而是单独维护一个 length。</p></li></ul></li> <li><p>方法</p> <ul><li><p><code>hasPlugin()</code></p></li> <li><p><code>getPluginOption()</code></p></li></ul></li></ul> <h5 id="commentsparser"><a href="#commentsparser" class="header-anchor">#</a> <code>CommentsParser</code></h5> <p>提供针对注释的各种处理工具。</p> <h5 id="parsererrors"><a href="#parsererrors" class="header-anchor">#</a> <code>ParserErrors</code></h5> <p>提供了对错误的统一处理工具，并集成了词法分析、语法分析过程中的所有可能出现的错误情况。</p> <ul><li><p><code>ParserErrors</code> 对外提供了一些工具对象</p> <ul><li><p><code>ErrorCodes</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> ErrorCodes <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">SyntaxError</span><span class="token operator">:</span> <span class="token string">&quot;BABEL_PARSER_SYNTAX_ERROR&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">SourceTypeModuleError</span><span class="token operator">:</span> <span class="token string">&quot;BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>ParsingError</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>type ErrorContext <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">pos</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
    <span class="token literal-property property">loc</span><span class="token operator">:</span> Position<span class="token punctuation">,</span>
    missingPlugin<span class="token operator">?</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    code<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
    reasonCode<span class="token operator">?</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> type ParsingError <span class="token operator">=</span> SyntaxError <span class="token operator">&amp;</span> ErrorContext<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>ErrorTemplate</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> type ErrorTemplate <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> ErrorCode<span class="token punctuation">,</span>
    <span class="token literal-property property">template</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
    <span class="token literal-property property">reasonCode</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>makeErrorTemplates()</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">makeErrorTemplates</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token literal-property property">messages</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>key<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> ErrorCode<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> ErrorTemplates 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors / SourceTypeModuleErrors</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span>
    ErrorMessages <span class="token keyword">as</span> Errors<span class="token punctuation">,</span>
    SourceTypeModuleErrorMessages <span class="token keyword">as</span> SourceTypeModuleErrors<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./error-message&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// error-message</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> SourceTypeModuleErrorMessages <span class="token operator">=</span> <span class="token function">makeErrorTemplates</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">ImportMetaOutsideModule</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import.meta may appear only with 'sourceType: &quot;module&quot;'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">ImportOutsideModule</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'import' and 'export' may appear only with 'sourceType: &quot;module&quot;'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/* code */</span> ErrorCodes<span class="token punctuation">.</span>SourceTypeModuleError<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ErrorMessages <span class="token operator">=</span> <span class="token function">makeErrorTemplates</span><span class="token punctuation">(</span>
<span class="token punctuation">{</span>
    <span class="token literal-property property">AccessorIsGenerator</span><span class="token operator">:</span> <span class="token string">&quot;A %0ter cannot be a generator.&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ArgumentsInClass</span><span class="token operator">:</span> <span class="token string">&quot;'arguments' is only allowed in functions and class methods.&quot;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> SyntaxError<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li> <li><p>``ParserErrors` 集成了词法分析、语法分析过程的所有错误描述</p> <p>相较于 <code>ParserError</code> 对外暴露了哪些对象，更容易帮助我们理解转译过程的，是转译过程中会关注哪些错误。</p> <p><code>ParserError</code> 集成了如下错误:</p> <p>TODO</p></li></ul> <h4 id="位置信息"><a href="#位置信息" class="header-anchor">#</a> 位置信息</h4> <p>文件 <code>babel/packages/babel-parser/src/util/location.js</code> 定义了一系列和代码位置相关的对象和方法。</p> <ul><li><p><code>Position</code> 类</p> <p>描述了目标字符在源码的行列信息（<code>line/column</code>），它是一个基础的位置类。</p></li> <li><p><code>SourceLocation</code> 类（依赖 <code>Position</code> 类）</p> <p>描述了目标字符串在源码的开始位置（<code>start: Position</code>）和结束位置（<code>end: Position</code>）等信息。</p></li> <li><p><code>getLineInfo(input: string, offset: number): Position</code></p> <p>该方法用于临时获取目标字符串的位置信息。比如出于性能考虑关闭语法分析时检测代码的位置信息后，仍可以通过该方法临时获取目标字符在源码的位置信息。</p></li></ul> <h4 id="工具方法"><a href="#工具方法" class="header-anchor">#</a> 工具方法</h4> <ul><li><p>节点处理类（<code>node</code>）</p> <ul><li><code>startNode()</code></li> <li><code>startNodeAt()</code></li> <li><code>startNodeAtNode()</code></li> <li><code>finishNode()</code></li> <li><code>finishNodeAt()</code></li> <li><code>resetStartLocation()</code></li> <li><code>resetEndLocation()</code></li> <li><code>resetStartLocationFromNode()</code></li></ul></li> <li><p>校验类（<code>util</code>）</p> <ul><li><p><code>isRelational(op: &quot;&lt;&quot; | &quot;&gt;&quot;): boolean</code></p> <p>是 <code>&lt;</code> 或 <code>&gt;</code> 节点。</p></li> <li><p><code>isContextual(name: string): boolean</code></p></li> <li><p><code>isUnparsedContextual</code></p></li> <li><p><code>isLookaheadContextual</code></p></li> <li><p><code>expectRelational</code></p></li> <li><p><code>expectContextual</code></p></li> <li><p><code>canInsertSemicolon</code></p></li> <li><p><code>hasPrecedingLineBreak</code></p></li> <li><p><code>hasFollowingLineBreak</code></p></li> <li><p><code>isLineTerminator</code></p></li> <li><p><code>semicolon</code></p></li> <li><p><code>expect</code></p></li> <li><p><code>assertNoSpace</code></p></li> <li><p><code>unexpected</code></p></li> <li><p><code>expectPlugin</code></p></li> <li><p><code>expectOnePlugin</code></p></li> <li><p><code>tryParse</code></p></li> <li><p><code>checkExpressionErrors</code></p></li> <li><p><code>isLiteralPropertyName</code></p></li> <li><p><code>isPrivateName</code></p></li> <li><p><code>hasPropertyAsPrivateName</code></p></li> <li><p><code>isOptionalChain</code></p></li> <li><p><code>isObjectProperty</code></p></li> <li><p><code>isObjectMethod</code></p></li></ul></li> <li><p>操作类（<code>util</code>）</p> <ul><li><p><code>addExtra(node: Node, key: string, val: any)</code></p> <p>给 <code>node</code> 的 <code>extra</code> 添加属性: <code>key/val</code>。</p></li> <li><p><code>eatContextual</code></p></li> <li><p><code>getPrivateNameSV</code></p></li> <li><p><code>initializeScopes</code></p></li> <li><p><code>enterInitialScopes</code></p></li></ul></li></ul> <h4 id="保留字识别"><a href="#保留字识别" class="header-anchor">#</a> 保留字识别</h4> <p>文件 <code>babel/packages/babel-parser/src/util/identifier.js</code> 定义了关于标识符的相关对象和方法。</p> <p>该文件描述了以下单词会被认为是 JavaScript 保留字:</p> <ul><li><p>无条件保留字</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">break</span> <span class="token operator">/</span> <span class="token keyword">case</span> <span class="token operator">/</span> catch <span class="token operator">/</span> <span class="token keyword">continue</span> <span class="token operator">/</span> <span class="token keyword">debugger</span> <span class="token operator">/</span> <span class="token keyword">default</span> <span class="token operator">/</span> <span class="token keyword">do</span> <span class="token operator">/</span> <span class="token keyword">else</span> <span class="token operator">/</span> finally <span class="token operator">/</span> <span class="token keyword">for</span> <span class="token operator">/</span> <span class="token keyword">function</span> <span class="token operator">/</span> <span class="token keyword">if</span> <span class="token operator">/</span> <span class="token keyword">return</span> <span class="token operator">/</span> <span class="token keyword">switch</span> <span class="token operator">/</span> <span class="token keyword">throw</span> <span class="token operator">/</span> <span class="token keyword">try</span> <span class="token operator">/</span> <span class="token keyword">var</span> <span class="token operator">/</span> <span class="token keyword">const</span> <span class="token operator">/</span> <span class="token keyword">while</span> <span class="token operator">/</span> <span class="token keyword">with</span> <span class="token operator">/</span> <span class="token keyword">new</span> <span class="token operator">/</span> <span class="token keyword">this</span> <span class="token operator">/</span> <span class="token keyword">super</span> <span class="token operator">/</span> <span class="token keyword">class</span> <span class="token operator">/</span> <span class="token keyword">extends</span> <span class="token operator">/</span> <span class="token keyword">export</span> <span class="token operator">/</span> <span class="token keyword">import</span> <span class="token operator">/</span> <span class="token keyword">null</span> <span class="token operator">/</span> <span class="token boolean">true</span> <span class="token operator">/</span> <span class="token boolean">false</span> <span class="token operator">/</span> <span class="token keyword">in</span> <span class="token operator">/</span> <span class="token keyword">instanceof</span> <span class="token operator">/</span> <span class="token keyword">typeof</span> <span class="token operator">/</span> <span class="token keyword">void</span> <span class="token operator">/</span> <span class="token keyword">delete</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>严格模式下的新增保留字</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">implements</span> <span class="token operator">/</span> <span class="token keyword">interface</span> <span class="token operator">/</span> <span class="token keyword">let</span> <span class="token operator">/</span> <span class="token keyword">package</span> <span class="token operator">/</span> <span class="token keyword">private</span> <span class="token operator">/</span> <span class="token keyword">protected</span> <span class="token operator">/</span> <span class="token keyword">public</span> <span class="token operator">/</span> <span class="token keyword">static</span> <span class="token operator">/</span> <span class="token keyword">yield</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>strictBind</code> 下的新增保留字</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>eval <span class="token operator">/</span> arguments
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>可能是保留字</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">enum</span> <span class="token operator">/</span> <span class="token keyword">await</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <p>工具包 <code>@babel/helper-validator-identifier</code> 也定义了一系列工具方法，在程序中判断保留字信息。</p> <h4 id="作用域处理-scope"><a href="#作用域处理-scope" class="header-anchor">#</a> 作用域处理（<code>scope</code>）</h4> <ul><li><p>什么是作用域</p> <p>作用域是当前的执行上下文，也就是值和表达式在其中&quot;可见&quot;或可被访问到的上下文。如果一个值或表达式不在&quot;当前的作用域中&quot;，那么它就是不可用的。</p> <p>我们知道，JavaScript 中存在三种作用域: 全局作用域、函数作用域、块级作用域。并且，JavaScript 是静态作用域，也就是在静态代码解析的时候，作用域已经确认了，因此，Babel 这样的工具也可以针对作用域做一些转译工作。</p> <p>Babel 针对这几种作用域做了更细致的划分，在文件 <code>babel/packages/babel-parser/src/util/scopeflags.js</code> 定义了一系列的作用域:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> type ScopeFlags <span class="token operator">=</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_OTHER</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_PROGRAM</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_FUNCTION</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_VAR</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_ARROW</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_SIMPLE_CATCH</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_SUPER</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_DIRECT_SUPER</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_CLASS</span>
<span class="token operator">|</span> <span class="token keyword">typeof</span> <span class="token constant">SCOPE_STATIC_BLOCK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>笔者整理了 Babel 定义的作用域和 JavaScript 作用域之间的关系:</p> <ul><li><p>全局作用域: <code>SCOPE_PROGRAM</code></p></li> <li><p>函数作用域: <code>SCOPE_FUNCTION</code></p> <p>箭头函数和普通函数。</p></li> <li><p>块级作用域</p> <ul><li><p><code>SCOPE_VAR</code></p></li> <li><p><code>SCOPE_ARROW</code></p> <p>箭头函数</p></li> <li><p><code>SCOPE_SIMPLE_CATCH</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这个区域</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>SCOPE_SUPER</code></p></li> <li><p><code>SCOPE_DIRECT_SUPER</code></p></li> <li><p><code>SCOPE_CLASS</code></p></li> <li><p><code>SCOPE_STATIC_BLOCK</code></p></li> <li><p><code>SCOPE_OTHER</code></p> <ul><li><code>ForStatement</code></li> <li><code>SwitchStatement</code></li> <li><code>TryStatement</code></li> <li><code>Block</code></li></ul></li></ul></li></ul></li> <li><p>作用域栈</p> <p>文件 <code>babel/packages/babel-parser/src/util/scope.js</code> 描述了 Babel 对作用域的各种处理。</p> <p>其中，该文件定义的 <code>Scope</code> 类维护了一个&quot;作用域栈&quot;（<code>scopeStack</code>），并提供了入栈方法 <code>enter()</code> 和出栈方法 <code>exit()</code>，如图:</p> <p>TODO</p> <p>当 Babel 解析表达式（<code>expression</code>）、语句（<code>statement</code>）等节点时，会频繁地通过递归方式进行节点解析的工作，TODO</p> <p>每进入一个新的节点解析时，一个新的 <code>scope</code> 作用域对象会入栈，在该新节点解析的过程中的上下文均以入栈的这个作用域对象为准，待新节点解析完毕，之前入栈的作用域对象就出栈。</p></li> <li><p>3 种作用域</p> <ul><li><code>this.scope</code></li> <li><code>this.classScope</code></li> <li><code>this.expressionScope</code></li></ul></li> <li><p><code>scope.js</code></p> <p>文件 <code>babel/packages/babel-parser/src/util/scope.js</code> 描述了 Babel 对作用域的各种工具属性和方法。</p> <p>不同的应用场景有不同的工具对应:</p> <ul><li><p><code>inFunction</code></p> <p>当前作用域处于某个函数体中。</p></li> <li><p><code>allowSuper</code></p> <p>当前作用域允许使用 <code>super()</code> 方法。</p></li> <li><p><code>allowDirectSuper</code></p> <p>当前作用有允许直接使用 <code>super()</code> 方法。</p></li> <li><p><code>inClass</code></p> <p>当前作用域处于 <code>class</code> 声明中。</p></li> <li><p><code>inClassAndNotInNonArrowFunction</code></p> <p>当前作用域位于 <code>class</code> 且是非箭头函数体中。</p></li> <li><p><code>inStaticBlock</code></p> <p>当前作用域位于 <code>statiBlock</code> 中。</p></li> <li><p><code>inNonArrowFunction</code></p> <p>当前作用域位于非箭头函数体中。</p></li> <li><p><code>treatFunctionsAsVar</code></p> <p>当前作用域位于中，函数是否可以被认为是 <code>var</code> 定义的函数对象。</p> <blockquote><p>从顶层作用域的角度看，函数声明可以被视为 <code>var</code> 定义的函数对象。</p></blockquote></li> <li><p><code>createScope()</code></p> <p>创建一个 <code>scope</code> 实例。</p></li> <li><p><code>enter()</code></p> <p>创建一个 <code>scope</code> 实例，并推入到 <code>scope</code> 栈。</p></li> <li><p><code>exit()</code></p> <p><code>scope</code> 栈推出。</p></li> <li><p><code>treatFunctionsAsVarInScope()</code></p> <p>同 <code>treatFunctionsAsVar()</code>。</p></li> <li><p><code>declareName()</code></p> <p>TODO</p></li> <li><p><code>maybeExportDefined()</code></p> <p>TODO</p></li> <li><p><code>checkRedeclarationInScope()</code></p> <p>检查是否重复定义，如果有，会抛出错误。</p></li> <li><p><code>isRedeclaredInScope()</code></p> <p>判断是否重复定义，如果有，不会抛出错误。</p></li> <li><p><code>checkLocalExport()</code></p> <p>TODO</p></li> <li><p><code>currentScope()</code></p> <p>获取 <code>scope</code> 栈顶项。</p></li> <li><p><code>currentVarScopeFlags()</code></p> <p>TODO</p></li> <li><p><code>currentThisScopeFlags()</code></p> <p>TODO</p></li></ul></li></ul> <h4 id="语句处理-statement"><a href="#语句处理-statement" class="header-anchor">#</a> 语句处理（<code>statement</code>）</h4> <p>文件 <code>babel/packages/babel-parser/src/statement.js</code> 描述了 Babel 对语句（<code>statement</code>）的各种处理。</p> <ul><li><p>生成语句节点</p> <p>首先看一下 statement 部分，解析了哪些 AST 节点:</p> <p>parseProgram --&gt; parseBlockBody --&gt; parseBlockOrModuleBlockBody --&gt; while body afterBlockParse</p> <p>这里列举了 <code>statement.js</code> 可以解析的节点列表:</p> <table><thead><tr><th>分类</th> <th>节点名称</th> <th>定义</th> <th>描述</th></tr></thead> <tbody><tr><td></td> <td><code>File</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>Program</code></td> <td>interface Program &lt;: Node {<br>  type: &quot;Program&quot;;<br>  interpreter: InterpreterDirective | null;<br>  sourceType: &quot;script&quot; | &quot;module&quot;;<br>  body: [ Statement | ModuleDeclaration ];<br>  directives: [ Directive ];<br>}</td> <td>根节点，AST顶部节点<br><br><code>body</code> 是一个数组，包括语句和模块声明<br><br>如果是 ES6 模块，必须指定 <code>sourceType</code> 为 <code>module</code>，否则指定为 <code>script</code></td></tr> <tr><td></td> <td><code>InterpreterDirective</code></td> <td>interface InterpreterDirective &lt;: StringLiteral {<br>  type: &quot;InterpreterDirective&quot;;<br>}</td> <td><code>#!</code>字面量</td></tr> <tr><td></td> <td><code>MemberExpression</code></td> <td>interface MemberExpression &lt;: Expression, Pattern {<br>  type: &quot;MemberExpression&quot;;<br>  object: Expression | Super;<br>  property: Expression | PrivateName;<br>  computed: boolean;<br>}</td> <td>成员表达式节点<br><br>表示引用对象成员，如 <code>obj.name</code> 或 <code>obj[&quot;name&quot;]</code><br><br>1. <code>object</code>: 表示对象表达式节点，如上例中的 <code>obj</code><br>2. <code>property</code>: 表示属性名称，如上例中的 <code>name</code><br>3. <code>computed</code>: 若为 <code>true</code>，表示 <code>obj[&quot;name&quot;]</code> 形式，<code>property</code> 需要为 <code>Expression</code> 节点；若为 <code>false</code>，表示 <code>obj.name</code> 形式，<code>property</code> 需要为 <code>Identifier</code> 节点</td></tr> <tr><td></td> <td><code>Decorator</code></td> <td>interface Decorator &lt;: Node {<br>  type: &quot;Decorator&quot;;<br>  expression: Expression;<br>}</td> <td>装饰器</td></tr> <tr><td></td> <td><code>CallExpression</code></td> <td>interface CallExpression &lt;: Expression {<br>  type: &quot;CallExpression&quot;;<br>  callee: Expression | Super | Import;<br>  arguments: [ Expression | SpreadElement ];<br>}</td> <td>函数调用表达式<br><br>如 <code>run(1, 2)</code> 这样的表达式。<br><br>1. <code>callee</code>: 表示函数，是表达式节点<br>2. <code>arguments</code>: 表示参数，为 <code>Expression</code> 或 <code>SpreadElement</code></td></tr> <tr><td></td> <td><code>BreakStatement</code></td> <td>interface BreakStatement &lt;: Statement {<br>  type: &quot;BreakStatement&quot;;<br>  label: Identifier | null;<br>}</td> <td>Break 语句<code>break [label?];</code></td></tr> <tr><td></td> <td><code>ContinueStatement</code></td> <td>interface ContinueStatement &lt;: Statement {<br>  type: &quot;ContinueStatement&quot;;<br>  label: Identifier | null;<br>}</td> <td>Continue 语句<br><br><code>continue [label?];</code></td></tr> <tr><td></td> <td><code>DebuggerStatement</code></td> <td>interface DebuggerStatement &lt;: Statement {<br>  type: &quot;DebuggerStatement&quot;;<br>}</td> <td>调试语句<br><br><code>debugger;</code></td></tr> <tr><td></td> <td><code>DoWhileStatement</code></td> <td>interface DoWhileStatement &lt;: Statement {<br>  type: &quot;DoWhileStatement&quot;;<br>  body: Statement;<br>  test: Expression;<br>}</td> <td>DoWhile语句<br><br><code>do {[test]} while ([body])</code></td></tr> <tr><td></td> <td><code>VariableDeclaration</code></td> <td>interface VariableDeclaration &lt;: Declaration {<br>  type: &quot;VariableDeclaration&quot;;<br>  declarations: [ VariableDeclarator ];<br>  kind: &quot;var&quot; | &quot;let&quot; | &quot;const&quot;;<br>}</td> <td>变量声明<br><br>如 <code>let a = 1;</code><br><br>1. <code>kind</code>: 表示是什么类型的声明<br>2. <code>declarations</code>: 表示声明的多个描述，比如 <code>let a = 1, b = 2;</code><br><br>例如: <br><br>1. <code>const a = 1</code><br>2. <code>let a = 1, b = 2</code></td></tr> <tr><td></td> <td><code>IfStatement</code></td> <td>interface IfStatement &lt;: Statement {<br>    type: &quot;IfStatement&quot;;<br>    test: Expression;<br>    consequent: Statement;<br>    alternate: Statement | null;<br>}</td> <td><code>if</code>语句<br><br><code>if ([test]) {[consequent]} else {[alternate]}</code><br><br>1. <code>test</code>表示<code>if (...)</code>括号中的表达式<br>2. <code>consequent</code>表示条件为 <code>true</code> 时的执行语句，通常是一个块语句<br>3. <code>alternate</code> 用来表示 <code>else</code> 后跟随的语句，通常也会是块语句，也可以又是一个 <code>if</code> 语句，例如 <code>else if (...)</code>，也可以是 <code>null</code></td></tr> <tr><td></td> <td><code>ReturnStatement</code></td> <td>interface ReturnStatement &lt;: Statement {<br>  type: &quot;ReturnStatement&quot;;<br>  argument: Expression | null;<br>}</td> <td>返回语句<br><br><code>return [argument]</code><br><br><code>argument</code> 为表达式或 null</td></tr> <tr><td></td> <td><code>SwitchCase</code></td> <td>interface SwitchCase &lt;: Node {<br>  type: &quot;SwitchCase&quot;;<br>  test: Expression | null;<br>  consequent: [ Statement ];<br>}</td> <td>SwitchCase节点<br><br><code>case: [test]: [consequent]</code></td></tr> <tr><td></td> <td><code>SwitchStatement</code></td> <td>interface SwitchStatement &lt;: Statement {<br>  type: &quot;SwitchStatement&quot;;<br>  discriminant: Expression;<br>  cases: [ SwitchCase ];<br>}</td> <td>switch语句<br><br><code>switch ([discriminant]) {[cases]}</code><br><br>1. <code>discriminant</code>: switch 后紧跟的表达式<br>2. <code>cases</code>: switchCase 节点数组</td></tr> <tr><td></td> <td><code>ThrowStatement</code></td> <td>interface ThrowStatement &lt;: Statement {<br>  type: &quot;ThrowStatement&quot;;<br>  argument: Expression;<br>}</td> <td>Throw语句<br><br><code>throw [argument]</code></td></tr> <tr><td></td> <td><code>CatchClause</code></td> <td>interface CatchClause &lt;: Node {<br>  type: &quot;CatchClause&quot;;<br>  param?: Pattern;<br>  body: BlockStatement;<br>}</td> <td>Catch从句节点<br><br>ES2019 允许 catch 从句为空：<code>try {} catch {}</code></td></tr> <tr><td></td> <td><code>TryStatement</code></td> <td>interface TryStatement &lt;: Statement {<br>  type: &quot;TryStatement&quot;;<br>  block: BlockStatement;<br>  handler: CatchClause | null;<br>  finalizer: BlockStatement | null;<br>}</td> <td>Try语句<br><br><code>try {[block]} catch {[handler]} finally {[finalizer]}</code></td></tr> <tr><td></td> <td><code>WhileStatement</code></td> <td>interface WhileStatement &lt;: Statement {<br>  type: &quot;WhileStatement&quot;;<br>  test: Expression;<br>  body: Statement;<br>}</td> <td>While语句<br><br><code>while ([test] {[body]}</code></td></tr> <tr><td></td> <td><code>WithStatement</code></td> <td>interface WithStatement &lt;: Statement {<br>  type: &quot;WithStatement&quot;;<br>  object: Expression;<br>  body: Statement;<br>}</td> <td>with 语句<br><br><code>with ([object]) {[body]}</code></td></tr> <tr><td></td> <td><code>EmptyStatement</code></td> <td>interface EmptyStatement &lt;: Statement {<br>  type: &quot;EmptyStatement&quot;;<br>}</td> <td>空语句<br><br><code>;</code></td></tr> <tr><td></td> <td><code>LabeledStatement</code></td> <td>interface LabeledStatement &lt;: Statement {<br>  type: &quot;LabeledStatement&quot;;<br>  label: Identifier;<br>  body: Statement;<br>}</td> <td>标签语句<br><br><code>loop: … break loop;</code></td></tr> <tr><td></td> <td><code>ExpressionStatement</code></td> <td>interface ExpressionStatement &lt;: Statement {<br>  type: &quot;ExpressionStatement&quot;;<br>  expression: Expression;<br>}</td> <td>表达式语句<br><br>如 <code>1 + 1</code></td></tr> <tr><td></td> <td><code>BlockStatement</code></td> <td>interface BlockStatement &lt;: Statement {<br>  type: &quot;BlockStatement&quot;;<br>  body: [ Statement ];<br>  directives: [ Directive ];<br>}</td> <td>块语句<br><br><code>{[body]}</code><br><br>例如：<code>if (...) { // 块语句部分 }</code><br><br>1. <code>body</code>: 内容节点列表<br>2. <code>directives</code>: ???</td></tr> <tr><td></td> <td><code>ForStatement</code></td> <td>interface ForStatement &lt;: Statement {<br>  type: &quot;ForStatement&quot;;<br>  init: VariableDeclaration | Expression | null;<br>  test: Expression | null;<br>  update: Expression | null;<br>  body: Statement;<br>}</td> <td>for 语句<br><br><code>for ([init];[test];[update]) {[body]}</code><br><br>1. <code>init/test/update</code>: 分别表示 <code>for</code> 语句括号中的三部分，分别为初始化值、循环判断条件、变量更新操作；三个均可以为 <code>null</code>，即 <code>for(;;){...}</code><br>2. <code>body</code>: 循环执行的语句</td></tr> <tr><td></td> <td><code>ForInStatement</code></td> <td>interface ForInStatement &lt;: Statement {<br>  type: &quot;ForInStatement&quot;;<br>  left: VariableDeclaration |  Expression;<br>  right: Expression;<br>  body: Statement;<br>}</td> <td>ForIn 语句<br><br><code>for ([left] in [right]) {[body]}</code></td></tr> <tr><td></td> <td><code>ForOfStatement</code></td> <td>interface ForOfStatement &lt;: ForInStatement {<br>  type: &quot;ForOfStatement&quot;;<br>  await: boolean;<br>}</td> <td>ForOf 语句<br><br><code>for (let [left] of [right])</code><br><br><code>await</code> 表示是否为异步迭代器 <code>for-await-of</code>: <code>for await (const x of obj) {}</code></td></tr> <tr><td></td> <td><code>VariableDeclarator</code></td> <td>interface VariableDeclarator &lt;: Node {<br>    type: &quot;VariableDeclarator&quot;;<br>    id: Pattern;<br>    init: Expression | null;<br>}</td> <td>变量声明的描述<br><br>1. <code>id</code> 表示变量名称节点<br>2. <code>init</code> 表示初始值的表达式，可以为 <code>null</code><br><br>例如: <br><br><code>a = 1</code></td></tr> <tr><td></td> <td><code>ClassDeclaration</code></td> <td>interface ClassDeclaration &lt;: Class, Declaration {<br>  type: &quot;ClassDeclaration&quot;;<br>  id: Identifier;<br>}</td> <td>类声明<br><br><code>class [name] [extends] {[body]}</code></td></tr> <tr><td></td> <td><code>ClassExpression</code></td> <td>interface ClassExpression &lt;: Class, Expression {<br>  type: &quot;ClassExpression&quot;;<br>}</td> <td>类表达式<br><br><code>const MyClass = class [className] [extends otherClassName] { ... }</code></td></tr> <tr><td></td> <td><code>ClassBody</code></td> <td>interface ClassBody &lt;: Node {<br>  type: &quot;ClassBody&quot;;<br>  body: [ <br>    ClassMethod | <br>    ClassPrivateMethod | <br>    ClassProperty | <br>    ClassPrivateProperty | <br>    StaticBlock <br>  ];<br>}</td> <td></td></tr> <tr><td></td> <td><code>ClassPrivateProperty</code></td> <td>interface ClassPrivateProperty &lt;: Node {<br>  type: &quot;ClassPrivateProperty&quot;;<br>  key: PrivateName;<br>  value: Expression;<br>  static: boolean;<br>}</td> <td></td></tr> <tr><td></td> <td><code>ClassProperty</code></td> <td>interface ClassProperty &lt;: Node {<br>  type: &quot;ClassProperty&quot;;<br>  key: Expression;<br>  value: Expression;<br>  static: boolean;<br>  computed: boolean;<br>}</td> <td></td></tr> <tr><td></td> <td><code>ExportAllDeclaration</code></td> <td>interface ExportAllDeclaration &lt;: ModuleDeclaration {<br>  type: &quot;ExportAllDeclaration&quot;;<br>  source: StringLiteral;<br>  assertions?: [ ImportAttribute ];<br>}</td> <td>全部导出声明<br><br>如 <code>export * from './a'</code></td></tr> <tr><td></td> <td><code>ExportNamedDeclaration</code></td> <td>interface ExportNamedDeclaration &lt;: ModuleDeclaration {<br>  type: &quot;ExportNamedDeclaration&quot;;<br>  declaration: Declaration | null;<br>  specifiers: [ ExportSpecifier ];<br>  source: StringLiteral | null;<br>  assertions?: [ ImportAttribute ];<br>}</td> <td>导出具名声明<br><br>如：<code>export { x, y as z }</code>、<code>export var a = 1</code>、<code>export { x } from 'a'</code></td></tr> <tr><td></td> <td><code>ExportDefaultDeclaration</code></td> <td>interface ExportDefaultDeclaration &lt;: <br>ModuleDeclaration {<br>  type: &quot;ExportDefaultDeclaration&quot;;<br>  declaration: <br>    OptFunctionDeclaration | <br>    OptClassDeclaration | <br>    Expression;<br>}</td> <td>默认导出声明<br><br>如 <code>export default a</code></td></tr> <tr><td></td> <td><code>ExportDefaultSpecifier</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>ExportNamespaceSpecifier</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>ExportSpecifier</code></td> <td>interface ExportSpecifier &lt;: ModuleSpecifier {<br>  type: &quot;ExportSpecifier&quot;;<br>  exported: Identifier | StringLiteral;<br>  local?: Identifier | StringLiteral;<br>}</td> <td>导出说明符<br><br>如 <code>export { a }</code>、<code>export { a as b }</code></td></tr> <tr><td></td> <td><code>ImportDeclaration</code></td> <td>interface ImportDeclaration &lt;: ModuleDeclaration {<br>  type: &quot;ImportDeclaration&quot;;<br>  importKind: null | &quot;type&quot; | &quot;typeof&quot; | &quot;value&quot;;<br>  specifiers: [ <br>    ImportSpecifier | <br>    ImportDefaultSpecifier | <br>    ImportNamespaceSpecifier <br>  ];<br>  source: StringLiteral;<br>  assertions?: [ ImportAttribute ];<br>}</td> <td>import 声明<br><br>如 <code>import a from &quot;./a&quot;</code></td></tr> <tr><td></td> <td><code>ImportDefaultSpecifier</code></td> <td>interface ImportDefaultSpecifier &lt;: ModuleSpecifier {<br>  type: &quot;ImportDefaultSpecifier&quot;;<br>}</td> <td>默认导入说明符<br><br>如 <code>import a from &quot;./a&quot;</code></td></tr> <tr><td></td> <td><code>ImportNamespaceSpecifier</code></td> <td>interface ImportNamespaceSpecifier &lt;: ModuleSpecifier {<br>  type: &quot;ImportNamespaceSpecifier&quot;;<br>}</td> <td>命名空间导入说明符<br><br>如 <code>import * as a from &quot;./a&quot;</code></td></tr> <tr><td></td> <td><code>ImportAttribute</code></td> <td>interface ImportAttribute &lt;: Node {<br>  type: &quot;ImportAttribute&quot;;<br>  key: Identifier;<br>  value: StringLiteral;<br>}</td> <td></td></tr> <tr><td></td> <td><code>ImportSpecifier</code></td> <td>interface ImportSpecifier &lt;: ModuleSpecifier {<br>  type: &quot;ImportSpecifier&quot;;<br>  imported: Identifier | StringLiteral;<br>}</td> <td>导入说明符<br><br>如 <code>import { a as b } from &quot;./a&quot;</code></td></tr></tbody></table></li> <li><p>校验AST节点</p> <ul><li><code>isLet</code></li> <li><code>isLetKeyword</code></li> <li><code>isValidDirective</code></li> <li><code>isExportDefaultSpecifier</code></li> <li><code>isThisParam</code></li> <li><code>canHaveLeadingDecorator</code></li> <li><code>assertModuleNodeAllowed</code></li> <li><code>verifyBreakContinue</code></li> <li><code>shouldParseExportDeclaration</code></li> <li><code>checkExport</code></li> <li><code>checkDeclaration</code></li> <li><code>checkDuplicateExports</code></li></ul></li></ul> <h4 id="表达式处理-expression"><a href="#表达式处理-expression" class="header-anchor">#</a> 表达式处理（<code>expression</code>）</h4> <p>文件 <code>babel/packages/babel-parser/src/statement.js</code> 描述了 Babel 对语句（statement）的各种处理。</p> <ul><li><p>生成表达式节点</p> <table><thead><tr><th>分类</th> <th>节点名称</th> <th>定义</th> <th>描述</th></tr></thead> <tbody><tr><td></td> <td><code>SequenceExpression</code></td> <td>interface SequenceExpression &lt;: Expression {<br>  type: &quot;SequenceExpression&quot;;<br>  expressions: [ Expression ];<br>}</td> <td>Sequence 表达式<br><br>如 <code>1, 2, 3</code></td></tr> <tr><td></td> <td><code>AssignmentExpression</code></td> <td>interface AssignmentExpression &lt;: Expression {<br>  type: &quot;AssignmentExpression&quot;;<br>  operator: AssignmentOperator;<br>  left: Pattern | Expression;<br>  right: Expression;<br>}</td> <td>赋值表达式节点<br><br>1. <code>operator</code>: 赋值运算符<br>2. <code>left/right</code>: 赋值运算符左右的表达式<br>3. <code>left</code>: ???</td></tr> <tr><td></td> <td><code>ConditionalExpression</code></td> <td>interface ConditionalExpression &lt;: Expression {<br>  type: &quot;ConditionalExpression&quot;;<br>  test: Expression;<br>  alternate: Expression;<br>  consequent: Expression;<br>}</td> <td>条件表达式<br><br>就是三元运算表达式，即 <code>a &gt; b ? c : d</code></td></tr> <tr><td></td> <td><code>LogicalExpression</code></td> <td>interface LogicalExpression &lt;: Expression {<br>  type: &quot;LogicalExpression&quot;;<br>  operator: LogicalOperator;<br>  left: Expression;<br>  right: Expression;<br>}</td> <td>逻辑运算表达式<br><br>如 <code>a &amp;&amp; b</code></td></tr> <tr><td></td> <td><code>BinaryExpression</code></td> <td>interface BinaryExpression &lt;: Expression {<br>  type: &quot;BinaryExpression&quot;;<br>  operator: BinaryOperator;<br>  left: Expression | PrivateName;<br>  right: Expression;<br>}</td> <td>二元运算表达式<br><br>如 <code>a &gt; b</code><br><br>1. <code>left/right</code>: 运算符左右的表达式<br>2. <code>operator</code>: 二元运算符节点<br>3. <code>left</code>: 还可以是 <code>PrivateName</code> 节点</td></tr> <tr><td></td> <td><code>UnaryExpression</code></td> <td>interface UnaryExpression &lt;: Expression {<br>  type: &quot;UnaryExpression&quot;;<br>  operator: UnaryOperator;<br>  prefix: boolean;<br>  argument: Expression;<br>}</td> <td>一元表达式<br><br>如 <code>typeof 1</code></td></tr> <tr><td></td> <td><code>UpdateExpression</code></td> <td>interface UpdateExpression &lt;: Expression {<br>  type: &quot;UpdateExpression&quot;;<br>  operator: UpdateOperator;<br>  argument: Expression;<br>  prefix: boolean;<br>}</td> <td>Update 表达式<br><br>如 <code>++a</code><br><br>1. <code>operator</code>: <code>UpdateOperator</code> 节点，即 <code>++/--</code><br>2. <code>argument</code>: 参数<br>3. <code>prefix</code>: 表示 <code>operator</code> 是否在前</td></tr> <tr><td></td> <td><code>OptionalMemberExpression</code></td> <td>interface OptionalMemberExpression &lt;: Expression {<br>  type: &quot;OptionalMemberExpression&quot;;<br>  object: Expression;<br>  property: Expression | PrivateName;<br>  computed: boolean;<br>  optional: boolean;<br>}</td> <td>可选链表达式<br><br><code>a?.b?.c</code></td></tr> <tr><td></td> <td><code>MemberExpression</code></td> <td>interface MemberExpression &lt;: Expression, Pattern {<br>  type: &quot;MemberExpression&quot;;<br>  object: Expression | Super;<br>  property: Expression | PrivateName;<br>  computed: boolean;<br>}</td> <td>成员表达式节点<br><br>表示引用对象成员，如 <code>obj.name</code> 或 <code>obj[&quot;name&quot;]</code><br><br>1. <code>object</code>: 表示对象表达式节点，如上例中的 <code>obj</code><br>2. <code>property</code>: 表示属性名称，如上例中的 <code>name</code><br>3. <code>computed</code>: 若为 <code>true</code>，表示 <code>obj[&quot;name&quot;]</code> 形式，<code>property</code> 需要为 <code>Expression</code> 节点；若为 <code>false</code>，表示 <code>obj.name</code> 形式，<code>property</code> 需要为 <code>Identifier</code> 节点</td></tr> <tr><td></td> <td><code>BindExpression</code></td> <td>interface BindExpression &lt;: Expression {<br>    type: &quot;BindExpression&quot;;<br>    object: Expression | null;<br>    callee: Expression;<br>}</td> <td></td></tr> <tr><td></td> <td><code>TaggedTemplateExpression</code></td> <td>interface TaggedTemplateExpression &lt;: Expression {<br>  type: &quot;TaggedTemplateExpression&quot;;<br>  tag: Expression;<br>  quasi: TemplateLiteral;<br>}</td> <td>带标签的模板字符串表达式<br><br>function tagFunc(...args) {<br>  return args;<br>}<br>const setting = 'dark mode';<br>console.log(tagFunc`Setting ${ setting } is ${ value }!`);</td></tr> <tr><td></td> <td><code>OptionalCallExpression</code></td> <td>interface OptionalCallExpression &lt;: Expression {<br>  type: &quot;OptionalCallExpression&quot;;<br>  callee: Expression;<br>  arguments: [ Expression | SpreadElement ];<br>  optional: boolean;<br>}</td> <td>可选执行方法节点<br>如<code>f?.()()</code>中的<code>?.()</code></td></tr> <tr><td></td> <td><code>CallExpression</code></td> <td>interface CallExpression &lt;: Expression {<br>  type: &quot;CallExpression&quot;;<br>  callee: Expression | Super | Import;<br>  arguments: [ Expression | SpreadElement ];<br>}</td> <td>函数调用表达式<br><br>如 <code>run(1, 2)</code> 这样的表达式。<br><br>1. <code>callee</code>: 表示函数，是表达式节点<br>2. <code>arguments</code>: 表示参数，为 <code>Expression</code> 或 <code>SpreadElement</code></td></tr> <tr><td></td> <td><code>Import</code></td> <td>interface Import &lt;: Node {<br>    type: &quot;Import&quot;;<br>}</td> <td>Import 表达式<br><br><code>import * from './a'</code></td></tr> <tr><td></td> <td><code>ThisExpression</code></td> <td>interface ThisExpression &lt;: Expression {<br>  type: &quot;ThisExpression&quot;;<br>}</td> <td>This表达式<br><br><code>this</code></td></tr> <tr><td></td> <td><code>PipelinePrimaryTopicReference</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>DoExpression</code></td> <td>interface DoExpression &lt;: Expression {<br>  type: &quot;DoExpression&quot;;<br>  body: BlockStatement;<br>}</td> <td>do表达式<br><br><code>do&amp;nbsp;{&amp;nbsp;...&amp;nbsp;}</code></td></tr> <tr><td></td> <td><code>Super</code></td> <td>interface Super &lt;: Node {<br>    type: &quot;Super&quot;;<br>}</td> <td>Super 表达式<br><br><code>super([arguments])</code></td></tr> <tr><td></td> <td><code>PrivateName</code></td> <td>interface PrivateName &lt;: Node {<br>  type: &quot;PrivateName&quot;;<br>  id: Identifier;<br>}</td> <td>表示私有的标识符</td></tr> <tr><td></td> <td><code>MetaProperty</code></td> <td>interface MetaProperty &lt;: Expression {<br>  type: &quot;MetaProperty&quot;;<br>  meta: Identifier;<br>  property: Identifier;<br>}</td> <td>元属性<br><br><code>new.target</code></td></tr> <tr><td></td> <td><code>StringLiteral</code></td> <td>interface StringLiteral &lt;: Literal {<br>  type: &quot;StringLiteral&quot;;<br>  value: string;<br>}</td> <td>字符串字面量</td></tr> <tr><td></td> <td><code>NumericLiteral</code></td> <td>interface NumericLiteral &lt;: Literal {<br>  type: &quot;NumericLiteral&quot;;<br>  value: number;<br>}</td> <td>数字字面量</td></tr> <tr><td></td> <td><code>BigIntLiteral</code></td> <td>interface BigIntLiteral &lt;: Literal {<br>  type: &quot;BigIntLiteral&quot;;<br>  value: string;<br>}</td> <td>BigInt 字面量</td></tr> <tr><td></td> <td><code>DecimalLiteral</code></td> <td>interface DecimalLiteral &lt;: Literal {<br>  type: &quot;DecimalLiteral&quot;;<br>  value: string;<br>}</td> <td></td></tr> <tr><td></td> <td><code>RegExpLiteral</code></td> <td>interface RegExpLiteral &lt;: Literal {<br>  type: &quot;RegExpLiteral&quot;;<br>  pattern: string;<br>  flags: string;<br>}</td> <td>正则字面量<br><br>1. <code>pattern</code>: 正则表达式内容字符，如 <code>/a/i</code> 中的<code>&quot;a&quot;</code><br>2. <code>flags</code>: <code>i</code>、<code>g</code>等标志</td></tr> <tr><td></td> <td><code>BooleanLiteral</code></td> <td>interface BooleanLiteral &lt;: Literal {<br>  type: &quot;BooleanLiteral&quot;;<br>  value: boolean;<br>}</td> <td>布尔值字面量</td></tr> <tr><td></td> <td><code>NullLiteral</code></td> <td>interface NullLiteral &lt;: Literal {<br>  type: &quot;NullLiteral&quot;;<br>}</td> <td>null 字面量</td></tr> <tr><td></td> <td><code>SequenceExpression</code></td> <td>interface SequenceExpression &lt;: Expression {<br>  type: &quot;SequenceExpression&quot;;<br>  expressions: [ Expression ];<br>}</td> <td>Sequence 表达式<br><br>如 <code>1, 2, 3</code></td></tr> <tr><td></td> <td><code>ParenthesizedExpression</code></td> <td>interface ParenthesizedExpression &lt;: Expression {<br>    type &quot;ParenthesizedExpression&quot;;<br>    expression: Expression;<br>}</td> <td>括号表达式</td></tr> <tr><td></td> <td><code>NewExpression</code></td> <td>interface NewExpression &lt;: CallExpression {<br>  type: &quot;NewExpression&quot;;<br>}</td> <td><code>new</code> 表达式<br><br>如<code>new Date()</code></td></tr> <tr><td></td> <td><code>TemplateElement</code></td> <td>interface TemplateElement &lt;: Node {<br>  type: &quot;TemplateElement&quot;;<br>  tail: boolean;<br>  value: {<br>    cooked: string | null;<br>    raw: string;<br>  };<br>}</td> <td>模板元素</td></tr> <tr><td></td> <td><code>TemplateLiteral</code></td> <td>interface TemplateLiteral &lt;: Expression {<br>  type: &quot;TemplateLiteral&quot;;<br>  quasis: [ TemplateElement ];<br>  expressions: [ Expression ];<br>}</td> <td>模板字面量<br><br><code>Hello ${name}</code></td></tr> <tr><td></td> <td><code>ObjectExpression</code></td> <td>interface ObjectExpression &lt;: Expression {<br>  type: &quot;ObjectExpression&quot;;<br>  properties: [ <br>    ObjectProperty | <br>    ObjectMethod | <br>    SpreadElement <br>  ];<br>}</td> <td>Object表达式<br><br>如 <code>&quot;{ a: 1 }&quot;</code><br><br><code>properties</code> 为数组，每个元素可以是： <br>1. <code>ObjectProperty</code> 节点<br>2. <code>ObjectMethod</code> 节点<br>3. <code>SpreadElement</code> 节点</td></tr> <tr><td></td> <td><code>ObjectPattern</code></td> <td>interface AssignmentProperty &lt;: ObjectProperty {<br>  value: Pattern;<br>}<br><br>interface ObjectPattern &lt;: Pattern {<br>  type: &quot;ObjectPattern&quot;;<br>  properties: [ AssignmentProperty | RestElement ];<br>}</td> <td></td></tr> <tr><td></td> <td><code>RecordExpression</code></td> <td>interface RecordExpression &lt;: Expression {<br>  type: &quot;RecordExpression&quot;;<br>  properties: [ <br>    ObjectProperty | <br>    ObjectMethod | <br>    SpreadElement <br>  ];<br>}</td> <td>Record表达式，如<code>#{ a: 1, b: '2' }</code></td></tr> <tr><td></td> <td><code>RestElement</code></td> <td>interface RestElement &lt;: Pattern {<br>  type: &quot;RestElement&quot;;<br>  argument: Pattern;<br>}</td> <td><code>fun(…args) {}</code></td></tr> <tr><td></td> <td><code>ObjectProperty</code></td> <td>interface ObjectProperty &lt;: ObjectMember {<br>  type: &quot;ObjectProperty&quot;;<br>  shorthand: boolean;<br>  value: Expression;<br>}</td> <td>属性节点</td></tr> <tr><td></td> <td><code>TupleExpression</code></td> <td>interface TupleExpression &lt;: Expression {<br>  type: &quot;TupleExpression&quot;;<br>  elements: [ Expression | SpreadElement | null ];<br>}</td> <td></td></tr> <tr><td></td> <td><code>ArrayExpression</code></td> <td>interface ArrayExpression &lt;: Expression {<br>  type: &quot;ArrayExpression&quot;;<br>  elements: [ Expression | SpreadElement | null ];<br>}</td> <td>数组表达式<br><br>如 <code>&quot;[1, 2, 3]&quot;</code><br><br><code>elements</code> 为数组，表示数组的多个元素，每个元素为表达式或 <code>null</code></td></tr> <tr><td></td> <td><code>ArrowFunctionExpression</code></td> <td>interface ArrowFunctionExpression &lt;: <br>Function, Expression {<br>  type: &quot;ArrowFunctionExpression&quot;;<br>  body: BlockStatement | Expression;<br>}</td> <td>箭头函数表达式<br><br><code>() =&gt; {[body]}</code></td></tr> <tr><td></td> <td><code>ArgumentPlaceholder</code></td> <td>interface ArgumentPlaceholder &lt;: Node {<br>    type: &quot;ArgumentPlaceholder&quot;;<br>}</td> <td></td></tr> <tr><td></td> <td><code>Identifier</code></td> <td>interface Identifier &lt;: Expression, Pattern {<br>    type: &quot;Identifier&quot;;<br>    name: string;<br>}</td> <td>标识符<br><br>即自定义名称，如变量名、属性名、函数名<br><br>一个标识符可以是一个表达式(<code>Expression</code>)，或者是解构(<code>Pattern</code>)</td></tr> <tr><td></td> <td><code>AwaitExpression</code></td> <td>interface AwaitExpression &lt;: Expression {<br>  type: &quot;AwaitExpression&quot;;<br>  argument: Expression | null;<br>}</td> <td>Await 表达式<br><br><code>await [argument]</code></td></tr> <tr><td></td> <td><code>YieldExpression</code></td> <td>interface YieldExpression &lt;: Expression {<br>  type: &quot;YieldExpression&quot;;<br>  argument: Expression | null;<br>  delegate: boolean;<br>}</td> <td>Yield 表达式<br><br><code>yield [argument]</code></td></tr> <tr><td></td> <td><code>PipelineBareFunction</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>PipelineTopicExpression</code></td> <td></td> <td></td></tr> <tr><td></td> <td><code>ModuleExpression</code></td> <td></td> <td></td></tr></tbody></table></li> <li><p>校验AST节点</p> <ul><li><code>checkProto()</code></li> <li><code>checkGetterSetterParams()</code></li> <li><code>checkParams()</code></li> <li><code>checkReservedWord()</code></li> <li><code>atPossibleAsyncArrow()</code></li> <li><code>shouldParseAsyncArrow()</code></li> <li><code>maybeAsyncOrAccessorProp()</code></li> <li><code>isSimpleParamList()</code></li> <li><code>isAwaitAllowed()</code></li> <li><code>isAmbiguousAwait()</code></li> <li><code>isSimpleReference()</code></li> <li><code>withTopicPermittingContext()</code></li></ul></li> <li><p>转换AST节点</p> <ul><li><code>toReferencedArguments()</code></li></ul></li></ul> <h4 id="左值处理-lval"><a href="#左值处理-lval" class="header-anchor">#</a> 左值处理（<code>lval</code>）</h4> <p>文件 <code>babel/packages/babel-parser/src/lvel.js</code> 描述了 Babel 对左值（ <code>lval</code> ）的各种处理。</p> <ul><li><p>生成的左值节点</p> <table><thead><tr><th>分类</th> <th>节点名称</th> <th>定义</th> <th>描述</th></tr></thead> <tbody><tr><td></td> <td><code>SpreadElement</code></td> <td>interface SpreadElement &lt;: Node {<br>  type: &quot;SpreadElement&quot;;<br>  argument: Expression;<br>}</td> <td>Spread 表达式<br><br>如 <code>[a, …b]</code></td></tr> <tr><td></td> <td><code>RestElement</code></td> <td>interface RestElement &lt;: Pattern {<br>  type: &quot;RestElement&quot;;<br>  argument: Pattern;<br>}</td> <td><code>fun(…args) {}</code></td></tr> <tr><td></td> <td><code>ArrayPattern</code></td> <td>interface ArrayPattern &lt;: Pattern {<br>  type: &quot;ArrayPattern&quot;;<br>  elements: [ Pattern | null ];<br>}</td> <td><code>[ name, age ] = [ 'Jack', 13 ]</code></td></tr> <tr><td></td> <td><code>AssignmentPattern</code></td> <td>interface AssignmentPattern &lt;: Pattern {<br>  type: &quot;AssignmentPattern&quot;;<br>  left: Pattern;<br>  right: Expression;<br>}</td> <td><code>fun(a = 10) {}</code></td></tr></tbody></table></li> <li><p>校验AST节点</p> <ul><li><code>isAssignable()</code></li> <li><code>checkLVal()</code></li> <li><code>checkToRestConversion()</code></li> <li><code>checkCommaAfterRest()</code></li></ul></li> <li><p>转换AST节点</p> <ul><li><code>toAssignable()</code></li> <li><code>toAssignableObjectExpressionProp()</code></li> <li><code>toAssignableList()</code></li> <li><code>toReferencedList()</code></li> <li><code>toReferencedListDeep()</code></li></ul></li></ul> <h4 id="错误处理"><a href="#错误处理" class="header-anchor">#</a> 错误处理</h4> <p>Babel 除了能够正确的进行语法分析和语义分析之外，错误扫描也是必不可少的工作。如果难以直观地梳理出 Babel 在语法分析和语义分析的各种细节逻辑的话，通过分析源码中的错误扫描部分，也可以帮助我们理解其分析逻辑。</p> <p>笔者梳理了 <code>babel/packages/babel-parser/</code> 下出现过的报错，以文件为单位分别介绍各自定义的错误。</p> <p>另外，所有错误的描述，定义为在 3 个对象上:</p> <ul><li><code>babel-parser/src/parser/error-message.js</code> 的 <code>ErrorMessages</code>，使用时重命名为 <code>Errors</code></li> <li><code>babel-parser/src/parser/error-message.js</code> 的 <code>SourceTypeModuleErrorMessages</code>，使用时重命名为 <code>SourceTypeModuleErrors</code></li> <li><code>babel-parser/src/plugins/jsx/index.js</code> 的 <code>JsxErrors</code>，使用时继续用 <code>JsxErrors</code></li></ul> <p>以下是 Babel 在解析 AST 节点过程中会抛出的错误。</p> <h5 id="语句类错误-statement-js"><a href="#语句类错误-statement-js" class="header-anchor">#</a> 语句类错误（<code>statement.js</code>）</h5> <ul><li><p><code>export</code> 的对象未定义</p> <p><code>Errors.ModuleExportUndefined</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Export <span class="token string">'%0'</span> is not defined.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>案例:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>babel<span class="token punctuation">.</span><span class="token function">transformSync</span><span class="token punctuation">(</span><span class="token string">'export { a }'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">parserOpts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">allowUndeclaredExports</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>会抛出错误:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Export <span class="token string">'a'</span> is not defined.

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span>
    <span class="token operator">|</span>          ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>在严格模式下，函数必须声明在顶层作用域或者块级作用域下</p> <p><code>Errors.StrictFunction</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>In strict mode code, functions can only be declared at <span class="token function">top</span> level or inside a block.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Babel 在解析该代码时，默认会转译为严格模式，也就会在转译时就抛出此类错误。</p> <p>如果调整转译配置:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>babel<span class="token punctuation">.</span><span class="token function">transformSync</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">parserOpts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">strictMode</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// striceMode 默认是 true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>那么在转译时就不会抛错了。</p></li> <li><p>非严格模式下，函数必须声明在顶层作用域、块级作用域或者作为 <code>if</code> 语句的 <code>body</code> 区域</p> <p><code>Errors.SloppyFunction</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>In non-strict mode code, functions can only be declared at <span class="token function">top</span> level, inside a block, or as the body of an <span class="token keyword">if</span> statement.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这些写法都是合法的:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>另外，在 <code>statement.js</code> 中，也允许函数声明出现在标签语句中，即: <code>label: function run() {}</code></p> <p>但这样的写法是不合法的:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>TODO</p> <p><code>Errors.UnexpectedLexicalDeclaration</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Lexical declaration cannot appear <span class="token keyword">in</span> a single-statement context.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下案例中:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个案例的转译报错并不是这个，而是 <code>Unexpected reserved word 'let'</code>。</p></li> <li><p><code>import</code> 和 <code>export</code> 必须出现在顶层作用域。</p> <p><code>Errors.UnexpectedImportExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'import'</span> and <span class="token string">'export'</span> may only appear at the <span class="token function">top</span> level.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在转译时就会抛出以下错误:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token string">'import'</span> and <span class="token string">'export'</span> may only appear at the <span class="token function">top</span> level. <span class="token punctuation">(</span><span class="token number">2</span>:4<span class="token punctuation">)</span>

<span class="token number">1</span> <span class="token operator">|</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
    <span class="token operator">|</span>     ^
<span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>async</code> 标记的函数必须定义在顶层作用域或块级作用域</p> <p><code>Errors.AsyncFunctionInSingleStatementContext</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Async functions can only be declared at the <span class="token function">top</span> level or inside a block.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这种写法的源码在转译时会触发该报错:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>装饰器必须作用于类的声明中</p> <p><code>Errors.UnexpectedLeadingDecorator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Leading decorators must be attached to a class declaration.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>举例:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@track greeting <span class="token operator">=</span> <span class="token string">'World'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Leading decorators must be attached to a class declaration. <span class="token punctuation">(</span><span class="token number">1</span>:7<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> @track greeting <span class="token operator">=</span> <span class="token string">'World'</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>        ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>非法的 <code>break</code> 或 <code>continue</code></p> <p><code>Errors.IllegalBreakContinue</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unsyntactic %0.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>表示非法的 <code>break</code> 或 <code>continue</code>。这两个词法单元只会作用于循环，如果没有写在循环里，转译时就会发现并且报错。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>会报错 <code>Unsyntactic break</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>会报错 <code>Unsyntactic continue</code>。</p></li> <li><p><code>Errors.ForOfLet</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>The left-hand side of a for-of loop may not start with <span class="token string">'let'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ForOfAsync</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>The left-hand side of a for-of loop may not be <span class="token string">'async'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p>非法的 <code>return</code></p> <p><code>Errors.IllegalReturn</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'return'</span> outside of function.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>转译时，函数体外出现了 <code>return</code> 会抛出此错误。</p> <p>比如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">return</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但如果这样配置，就允许函数体外出现 <code>return</code>:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>babel<span class="token punctuation">.</span><span class="token function">transformSync</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">parserOpts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">allowReturnOutsideFunction</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>switch</code> 语句中是否有多余的 <code>default</code></p> <p><code>Errors.MultipleDefaultsInSwitch</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Multiple default clauses.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">switch</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'Jack'</span><span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>throw</code> 不允许出现换行符</p> <p><code>Errors.NewlineAfterThrow</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Illegal newline after throw.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">throw</span>
<span class="token string">'error'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><code>Errors.NoCatchOrFinally</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Missing catch or finally clause.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><code>Errors.StrictWith</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'with'</span> <span class="token keyword">in</span> strict mode.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">with</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><code>Errors.LabelRedeclaration</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Label <span class="token string">'%0'</span> is already declared.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ForInOfLoopInitializer</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'%0'</span> loop variable declaration may not have an initializer.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> iterable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">50</span> <span class="token keyword">of</span> iterable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>转译时会抛出错误:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'for-of'</span> loop variable declaration may not have an initializer. <span class="token punctuation">(</span><span class="token number">3</span>:5<span class="token punctuation">)</span>

<span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">let</span> iterable <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span>, <span class="token number">20</span>, <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>let value <span class="token operator">=</span> <span class="token number">50</span> of iterable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span>      ^
<span class="token number">4</span> <span class="token operator">|</span>   console.log<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>Errors.InvalidLhs</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Invalid left-hand side <span class="token keyword">in</span> %0.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Invalid left-hand side <span class="token keyword">in</span> assignment expression. <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">|</span> ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.DeclarationMissingInitializer</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'%0'</span> require an initialization value.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> x<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token string">'Const declarations'</span> require an initialization value. <span class="token punctuation">(</span><span class="token number">1</span>:7<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> const x<span class="token punctuation">;</span>
    <span class="token operator">|</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.GeneratorInSingleStatementContext</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Generators can only be declared at the <span class="token function">top</span> level or inside a block.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>已知，在非严格模式下，这样的写法是合法的:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但 Generator 函数例外，这样的写法是非法的:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.DecoratorSemicolon</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators must not be followed by a semicolon.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">XXX</span> <span class="token punctuation">{</span>
    @<span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 这是伪代码</span>
babel<span class="token punctuation">.</span><span class="token function">transformSync</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'babel-plugin-proposal-decorators'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">decoratorsBeforeExport</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">SyntaxError</span><span class="token operator">:</span> unknown<span class="token operator">:</span> Decorators must not be followed by a semicolon<span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     @<span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>                <span class="token operator">^</span>
  <span class="token number">3</span> <span class="token operator">|</span>     <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token number">4</span> <span class="token operator">|</span>         <span class="token comment">//</span>
  <span class="token number">5</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>Errors.TrailingDecorator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators must be attached to a class element.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>@on name <span class="token operator">=</span><span class="token string">'Jack'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Leading decorators must be attached to a class declaration. <span class="token punctuation">(</span><span class="token number">2</span>:7<span class="token punctuation">)</span>

<span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span> @track greeting <span class="token operator">=</span><span class="token string">'World'</span><span class="token punctuation">;</span>
    <span class="token operator">|</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.ConstructorIsGenerator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Constructor can't be a generator.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Constructor can't be a generator. <span class="token punctuation">(</span><span class="token number">2</span>:6<span class="token punctuation">)</span>

<span class="token number">1</span> <span class="token operator">|</span> class Test <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     * <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token operator">|</span>       ^
<span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors.DuplicateConstructor</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Duplicate constructor <span class="token keyword">in</span> the same class.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Duplicate constructor <span class="token keyword">in</span> the same class. <span class="token punctuation">(</span><span class="token number">3</span>:4<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class Test <span class="token punctuation">{</span>
  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span>     <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token operator">|</span>     ^
  <span class="token number">4</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>Errors.OverrideOnConstructor</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'override'</span> modifier cannot appear on a constructor declaration.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ConstructorIsAsync</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Constructor can't be an async function.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Constructor can't be an async function. <span class="token punctuation">(</span><span class="token number">2</span>:10<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class Test <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     async <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token operator">|</span>           ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors.ConstructorIsAccessor</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Class constructor may not be an accessor.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.StaticPrototype</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Classes may not have static property named prototype.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Classes may not have static property named prototype. <span class="token punctuation">(</span><span class="token number">2</span>:11<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class X <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     static prototype<span class="token punctuation">;</span>
    <span class="token operator">|</span>            ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors.ConstructorClassPrivateField</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Classes may not have a private field named <span class="token string">'#constructor'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token function">#constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Classes may not have a private field named <span class="token string">'#constructor'</span><span class="token builtin class-name">.</span> <span class="token punctuation">(</span><span class="token number">2</span>:4<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class Test <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     <span class="token comment">#constructor() {}</span>
    <span class="token operator">|</span>     ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors.DecoratorStaticBlock</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators can't be used with a static block.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    @<span class="token function">decorator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Decorators can't be used with a static block. <span class="token punctuation">(</span><span class="token number">6</span>:4<span class="token punctuation">)</span>

  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
  <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token operator">|</span>     @decorator<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">|</span>     ^
  <span class="token number">7</span> <span class="token operator">|</span>     static <span class="token punctuation">{</span>
  <span class="token number">8</span> <span class="token operator">|</span>
  <span class="token number">9</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p><code>Errors.ConstructorClassField</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Classes may not have a field named <span class="token string">'constructor'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">constructor</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Classes may not have a field named <span class="token string">'constructor'</span><span class="token builtin class-name">.</span> <span class="token punctuation">(</span><span class="token number">2</span>:4<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class X <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     constructor <span class="token operator">=</span> <span class="token function-name function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span>     ^
  <span class="token number">3</span> <span class="token operator">|</span>
  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>Errors.DecoratorBeforeExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators must be placed *before* the <span class="token string">'export'</span> keyword. You can <span class="token builtin class-name">set</span> the <span class="token string">'decoratorsBeforeExport'</span> option to <span class="token boolean">false</span> to use the <span class="token string">'export @decorator class {}'</span> syntax.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> @decorator <span class="token keyword">class</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> @decorator class <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token operator">|</span>        ^
  <span class="token number">2</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><code>Errors.UnsupportedDefaultExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Only expressions, functions or classes are allowed as the <span class="token variable"><span class="token variable">`</span>default<span class="token variable">`</span></span> export.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Only expressions, functions or classes are allowed as the <span class="token variable"><span class="token variable">`</span>default<span class="token variable">`</span></span> export. <span class="token punctuation">(</span><span class="token number">1</span>:15<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> default const x <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">|</span>                ^
  <span class="token number">2</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.ExportDefaultFromAsIdentifier</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'from'</span> is not allowed as an identifier after <span class="token string">'export default'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> from <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> from<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token string">'from'</span> is not allowed as an identifier after <span class="token string">'export default'</span><span class="token builtin class-name">.</span> <span class="token punctuation">(</span><span class="token number">2</span>:15<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> const from <span class="token operator">=</span> <span class="token number">1</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> default from<span class="token punctuation">;</span>
    <span class="token operator">|</span>                ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.ExportBindingIsString</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>A string literal cannot be used as an exported binding without <span class="token variable"><span class="token variable">`</span>from<span class="token variable">`</span></span>.<span class="token punctuation">\</span>n- Did you mean <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">export</span> <span class="token punctuation">{</span> <span class="token string">'%0'</span> as <span class="token string">'%1'</span> <span class="token punctuation">}</span> from <span class="token string">'some-module'</span><span class="token variable">`</span></span>?
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.UnsupportedDecoratorExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>A decorated <span class="token builtin class-name">export</span> must <span class="token builtin class-name">export</span> a class declaration.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.DuplicateDefaultExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Only one default <span class="token builtin class-name">export</span> allowed per module.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> x
<span class="token keyword">export</span> <span class="token keyword">default</span> y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Only one default <span class="token builtin class-name">export</span> allowed per module. <span class="token punctuation">(</span><span class="token number">2</span>:0<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> default x
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> default y
    <span class="token operator">|</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.DuplicateExport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token variable"><span class="token variable">`</span>%0<span class="token variable">`</span></span> has already been exported. Exported identifiers must be unique.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
    <span class="token operator">|</span>          ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><code>Errors.ModuleExportNameHasLoneSurrogate</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>An <span class="token builtin class-name">export</span> name cannot include a lone surrogate, found <span class="token string">'\\u%0'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ModuleAttributesWithDuplicateKeys</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Duplicate key <span class="token string">&quot;%0&quot;</span> is not allowed <span class="token keyword">in</span> module attributes.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ModuleAttributeDifferentFromType</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>The only accepted module attribute is <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">type</span><span class="token variable">`</span></span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.DestructureNamedImport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ES2015 named imports <span class="token keyword">do</span> not destructure. Use another statement <span class="token keyword">for</span> destructuring after the import.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.ImportBindingIsString</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>A string literal cannot be used as an imported binding.<span class="token punctuation">\</span>n- Did you mean <span class="token variable"><span class="token variable">`</span><span class="token function">import</span> <span class="token punctuation">{</span> <span class="token string">&quot;%0&quot;</span> as foo <span class="token punctuation">}</span><span class="token variable">`</span></span>?
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>SourceTypeModuleErrors.ImportOutsideModule</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'import'</span> and <span class="token string">'export'</span> may appear only with <span class="token string">'sourceType: &quot;module&quot;'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token string">'import'</span> and <span class="token string">'export'</span> may appear only with <span class="token string">'sourceType: &quot;module&quot;'</span> <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>
Consider renaming the <span class="token function">file</span> to <span class="token string">'.mjs'</span>, or setting sourceType:module or sourceType:unambiguous <span class="token keyword">in</span> your Babel config <span class="token keyword">for</span> this file.

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">export</span> <span class="token punctuation">{</span> x <span class="token punctuation">}</span>
    <span class="token operator">|</span> ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h5 id="表达式类错误-expression-js"><a href="#表达式类错误-expression-js" class="header-anchor">#</a> 表达式类错误（<code>expression.js</code>）</h5> <ul><li><p><code>SourceTypeModuleErrors.ImportMetaOutsideModule</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>import.meta may appear only with <span class="token string">'sourceType: &quot;module&quot;'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token string">'import.meta'</span>

 babel<span class="token punctuation">.</span><span class="token function">transformSync</span><span class="token punctuation">(</span><span class="token string">'import.meta'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">parserOpts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">'script'</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: import.meta may appear only with <span class="token string">'sourceType: &quot;module&quot;'</span> <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>
Consider renaming the <span class="token function">file</span> to <span class="token string">'.mjs'</span>, or setting sourceType:module or sourceType:unambiguous <span class="token keyword">in</span> your Babel config <span class="token keyword">for</span> this file.

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> import.meta
    <span class="token operator">|</span> ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.RecordNoProto</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'__proto__'</span> is not allowed <span class="token keyword">in</span> Record expressions.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.DuplicateProto</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Redefinition of __proto__ property.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.UnexpectedAwaitAfterPipelineBody</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected <span class="token string">&quot;await&quot;</span> after pipeline body<span class="token punctuation">;</span> await must have parentheses <span class="token keyword">in</span> minimal proposal.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.MixingCoalesceWithLogical</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Nullish coalescing operator<span class="token punctuation">(</span>??<span class="token punctuation">)</span> requires parens when mixing with logical operators.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TODO</p></li> <li><p><code>Errors.UnexpectedTokenUnaryExponentiation</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Illegal expression. Wrap left hand side or entire exponentiation <span class="token keyword">in</span> parentheses.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.StrictDelete</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Deleting <span class="token builtin class-name">local</span> variable <span class="token keyword">in</span> strict mode.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.DeletePrivateField</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Deleting a private field is not allowed.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.SuperPrivateField</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Private fields can't be accessed on super.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.OptionalChainingNoTemplate</code></p> <p>https://github.com/tc39/proposal-optional-chaining/issues/54</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Tagged Template Literals are not allowed <span class="token keyword">in</span> optionalChain.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.ImportCallArity</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'import()'</span> requires exactly %0.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token variable"><span class="token variable">`</span>import<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> requires exactly one argument. <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> import<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.ImportCallSpreadArgument</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'...'</span> is not allowed <span class="token keyword">in</span> <span class="token string">'import()'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token operator">...</span>x<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">..</span>.<span class="token variable">`</span></span> is not allowed <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span>import<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span><span class="token builtin class-name">.</span> <span class="token punctuation">(</span><span class="token number">1</span>:7<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> import<span class="token punctuation">(</span><span class="token punctuation">..</span>.x<span class="token punctuation">)</span>
    <span class="token operator">|</span>        ^
  <span class="token number">2</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><code>Errors.ImportCallArgumentTrailingComma</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Trailing comma is disallowed inside import<span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span> arguments.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./x.js'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Trailing comma is disallowed inside import<span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span> arguments. <span class="token punctuation">(</span><span class="token number">1</span>:15<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> import<span class="token punctuation">(</span><span class="token string">'./x.js'</span>, <span class="token punctuation">)</span>
    <span class="token operator">|</span>                ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.UnsupportedImport</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'import'</span> can only be used <span class="token keyword">in</span> <span class="token string">'import()'</span> or <span class="token string">'import.meta'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnsupportedBind</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Binding should be performed on object property.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PrivateInExpectedIn</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Private names are only allowed <span class="token keyword">in</span> property accesses <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>obj.<span class="token comment">#%0</span><span class="token variable">`</span></span><span class="token punctuation">)</span> or <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span><span class="token keyword">in</span><span class="token variable">`</span></span> expressions <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span><span class="token comment">#%0 in obj</span><span class="token variable">`</span></span><span class="token punctuation">)</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PrimaryTopicRequiresSmartPipeline</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Primary Topic Reference found but pipelineOperator not passed <span class="token string">'smart'</span> <span class="token keyword">for</span> <span class="token string">'proposal'</span> option.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PrimaryTopicNotAllowed</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Topic reference was used <span class="token keyword">in</span> a lexical context without topic binding.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.LineTerminatorBeforeArrow</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>No line <span class="token builtin class-name">break</span> is allowed before <span class="token string">'=&gt;'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnsupportedSuper</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'super'</span> can only be used with <span class="token keyword">function</span> calls <span class="token punctuation">(</span>i.e. super<span class="token punctuation">(</span><span class="token punctuation">))</span> or <span class="token keyword">in</span> property accesses <span class="token punctuation">(</span>i.e. super.prop or super<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>示例1:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token variable"><span class="token variable">`</span>super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> is only valid inside a class constructor of a subclass. Maybe a typo <span class="token keyword">in</span> the method name <span class="token punctuation">(</span><span class="token string">'constructor'</span><span class="token punctuation">)</span> or not extending another class? <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> super<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> ^
  <span class="token number">2</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例2:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Run</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token variable"><span class="token variable">`</span>super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span> is only valid inside a class constructor of a subclass. Maybe a typo <span class="token keyword">in</span> the method name <span class="token punctuation">(</span><span class="token string">'constructor'</span><span class="token punctuation">)</span> or not extending another class? <span class="token punctuation">(</span><span class="token number">4</span>:12<span class="token punctuation">)</span>

  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token function-name function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token number">3</span> <span class="token operator">|</span>         <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">4</span> <span class="token operator">|</span>             super<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">|</span>             ^
  <span class="token number">5</span> <span class="token operator">|</span>         <span class="token punctuation">}</span>
  <span class="token number">6</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
  <span class="token number">7</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p><code>Errors.UnexpectedPrivateField</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Private names can only be used as the name of a class element 
<span class="token punctuation">(</span>i.e. <span class="token string">&quot;class C { #p = 42; #m() {} }&quot;</span><span class="token punctuation">)</span> 
or 
a property of member expression <span class="token punctuation">(</span>i.e. <span class="token string">&quot;this.#p&quot;</span><span class="token punctuation">)</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    #name<span class="token operator">:</span> <span class="token string">'Jack'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token number">1</span> <span class="token operator">|</span> const obj <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     <span class="token comment">#name: 'Jack'</span>
    <span class="token operator">|</span>      ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.UnsupportedMetaProperty</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>The only valid meta property <span class="token keyword">for</span> %0 is %0.%1.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">.</span>name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: The only valid meta property <span class="token keyword">for</span> <span class="token function">import</span> is import.meta. <span class="token punctuation">(</span><span class="token number">1</span>:7<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> import.name
    <span class="token operator">|</span>        ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.UnexpectedNewTarget</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">&quot;new.target&quot;</span> can only be used <span class="token keyword">in</span> functions or class properties.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span><span class="token punctuation">.</span>target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token variable"><span class="token variable">`</span>new.target<span class="token variable">`</span></span> can only be used <span class="token keyword">in</span> functions or class properties. <span class="token punctuation">(</span><span class="token number">1</span>:0<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> new.target
    <span class="token operator">|</span> ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.ImportCallNotNewExpression</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Cannot use new with import<span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">import</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Cannot use new with import<span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>. <span class="token punctuation">(</span><span class="token number">1</span>:4<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> new import<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token operator">|</span>     ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.OptionalChainingNoNew</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Constructors in/after an Optional Chain are not allowed.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> man <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">person</span><span class="token operator">?.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Constructors in/after an Optional Chain are not allowed. <span class="token punctuation">(</span><span class="token number">7</span>:28<span class="token punctuation">)</span>

  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token operator">|</span> const <span class="token function">man</span> <span class="token operator">=</span> new person?.name<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">|</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>Errors.InvalidEscapeSequenceTemplate</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Invalid escape sequence <span class="token keyword">in</span> template.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.InvalidRecordProperty</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Only properties and spread elements are allowed <span class="token keyword">in</span> record definitions.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnsupportedPropertyDecorator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators cannot be used to decorate object literal properties.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.AccessorIsGenerator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>A %0ter cannot be a generator.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.BadSetterRestParameter</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>A <span class="token string">'set'</span> accesor <span class="token keyword">function</span> argument must not be a rest parameter.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.IllegalLanguageModeDirective</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Illegal <span class="token string">'use strict'</span> directive <span class="token keyword">in</span> <span class="token keyword">function</span> with non-simple parameter list.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnexpectedToken</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected token <span class="token string">'%0'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnexpectedArgumentPlaceholder</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected argument placeholder.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.YieldBindingIdentifier</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Can not use <span class="token string">'yield'</span> as identifier inside a generator.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">yield</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token number">1</span> <span class="token operator">|</span> const run <span class="token operator">=</span> function* <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     const yield <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>           ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.AwaitBindingIdentifier</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Can not use <span class="token string">'await'</span> as identifier inside an async function.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">await</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token number">2</span> <span class="token operator">|</span> const run <span class="token operator">=</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span>     const await <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>           ^
  <span class="token number">4</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.AwaitBindingIdentifierInStaticBlock</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Can not use <span class="token string">'await'</span> as identifier inside a static block.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.ArgumentsInClass</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'arguments'</span> is only allowed <span class="token keyword">in</span> functions and class methods.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnexpectedKeyword</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected keyword <span class="token string">'%0'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnexpectedReservedWord</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected reserved word <span class="token string">'%0'</span><span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.ObsoleteAwaitStar</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'await*'</span> has been removed from the async functions proposal. Use Promise.all<span class="token punctuation">(</span><span class="token punctuation">)</span> instead.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PipelineHeadSequenceExpression</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Pipeline <span class="token function">head</span> should not be a comma-separated sequence expression.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PipelineBodySequenceExpression</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Pipeline body may not be a comma-separated sequence expression.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PipelineTopicUnused</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Pipeline is <span class="token keyword">in</span> topic style but does not use topic reference.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h5 id="左值类错误-lval-js"><a href="#左值类错误-lval-js" class="header-anchor">#</a> 左值类错误（<code>lval.js</code>）</h5> <ul><li><p><code>Errors.InvalidParenthesizedAssignment</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Invalid parenthesized assignment pattern.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Invalid parenthesized assignment pattern. <span class="token punctuation">(</span><span class="token number">1</span>:13<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> const <span class="token function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a, b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token builtin class-name">return</span> a + b<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>              ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.MissingEqInAssignment</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Only <span class="token string">'='</span> operator can be used <span class="token keyword">for</span> specifying default value.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnsupportedParameterDecorator</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Decorators cannot be used to decorate parameters.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
    <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token parameter">@MyDecorator myArg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Decorators cannot be used to decorate parameters. <span class="token punctuation">(</span><span class="token number">2</span>:15<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> class MyClass <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     myFunction<span class="token punctuation">(</span>@MyDecorator myArg<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">|</span>                ^
  <span class="token number">3</span> <span class="token operator">|</span>         
  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">}</span>
  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>Errors.ParamDupe</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Argument name clash.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> req</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Argument name clash. <span class="token punctuation">(</span><span class="token number">1</span>:18<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">function</span> run<span class="token punctuation">(</span>req, req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span>                   ^
  <span class="token number">2</span> <span class="token operator">|</span>     
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">4</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>Errors.LetInLexicalBinding</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token string">'let'</span> is not allowed to be used as a name <span class="token keyword">in</span> <span class="token string">'let'</span> or <span class="token string">'const'</span> declarations.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token keyword">let</span> <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: <span class="token string">'let'</span> is not allowed to be used as a name <span class="token keyword">in</span> <span class="token string">'let'</span> or <span class="token string">'const'</span> declarations. <span class="token punctuation">(</span><span class="token number">1</span>:4<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token builtin class-name">let</span> <span class="token builtin class-name">let</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token operator">|</span>     ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.InvalidPropertyBindingPattern</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Binding member expression.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.InvalidLhs</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Invalid left-hand side <span class="token keyword">in</span> %0.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span> x <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Invalid left-hand side <span class="token keyword">in</span> assignment expression. <span class="token punctuation">(</span><span class="token number">1</span>:4<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> if<span class="token punctuation">(</span> x <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span>     ^
  <span class="token number">2</span> <span class="token operator">|</span>     
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">4</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>Errors.InvalidLhsBinding</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Binding invalid left-hand side <span class="token keyword">in</span> %0.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a <span class="token operator">-</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">-</span> b
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Binding invalid left-hand side <span class="token keyword">in</span> <span class="token keyword">function</span> parameter list. <span class="token punctuation">(</span><span class="token number">1</span>:12<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> data1.sort<span class="token punctuation">((</span>a - b<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span>             ^
  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> a.count - b.count
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token number">4</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>Errors.InvalidRestAssignmentPattern</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Invalid rest operator's argument.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.ElementAfterRest</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Rest element must be last element.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token operator">...</span>param1<span class="token punctuation">,</span> param2 <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Rest element must be last element. <span class="token punctuation">(</span><span class="token number">1</span>:15<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> const run <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">..</span>.param1, param2 <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token operator">|</span>                ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>Errors.RestTrailingComma</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unexpected trailing comma after rest element.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token operator">...</span>c<span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Unexpected trailing comma after rest element. <span class="token punctuation">(</span><span class="token number">1</span>:18<span class="token punctuation">)</span>

<span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">|</span> const <span class="token punctuation">[</span> a, b, <span class="token punctuation">..</span>.c, <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">|</span>                   ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h5 id="作用域类错误"><a href="#作用域类错误" class="header-anchor">#</a> 作用域类错误</h5> <ul><li><p><code>class-scope.js</code></p> <ul><li><p><code>Errors.InvalidPrivateFieldResolution</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Private name <span class="token comment">#%0 is not defined.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.PrivateNameRedeclaration</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Duplicate private name <span class="token comment">#%0.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p><code>scope.js</code></p> <ul><li><p><code>Errors.VarRedeclaration</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Identifier <span class="token string">'%0'</span> has already been declared.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Identifier <span class="token string">'x'</span> has already been declared. <span class="token punctuation">(</span><span class="token number">2</span>:6<span class="token punctuation">)</span>

<span class="token number">1</span> <span class="token operator">|</span> const x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span> const x <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token operator">|</span>       ^
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul> <h5 id="jsx-类错误"><a href="#jsx-类错误" class="header-anchor">#</a> jsx 类错误</h5> <ul><li><p><code>ErrorCodes.SyntaxError</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>BABEL_PARSER_SYNTAX_ERROR
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>Errors.UnterminatedString</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unterminated string constant.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> 'Jack&quot;
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Unterminated string constant. <span class="token punctuation">(</span><span class="token number">2</span>:11<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token function-name function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> 'Jack&quot;
    <span class="token operator">|</span>            ^
  <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">4</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>JsxErrors.UnterminatedJsxContent</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Unterminated JSX contents.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Unterminated JSX contents. <span class="token punctuation">(</span><span class="token number">3</span>:13<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token function-name function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> <span class="token punctuation">(</span>  
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span>         <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">|</span>              ^
  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">)</span>
  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">6</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p><code>JsxErrors.AttributeIsEmpty</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>JSX attributes must only be assigned a non-empty expression.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  
        <span class="token operator">&lt;</span>div title<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: JSX attributes must only be assigned a non-empty expression. <span class="token punctuation">(</span><span class="token number">3</span>:19<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token function-name function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> <span class="token punctuation">(</span>  
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span>         <span class="token operator">&lt;</span>div <span class="token assign-left variable">title</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
    <span class="token operator">|</span>                    ^
  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">)</span>
  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">6</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p><code>JsxErrors.UnsupportedJsxValue</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>JSX value should be either an expression or a quoted JSX text.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  
        <span class="token operator">&lt;</span>div title<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: JSX value should be either an expression or a quoted JSX text. <span class="token punctuation">(</span><span class="token number">3</span>:19<span class="token punctuation">)</span>

  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token function-name function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> <span class="token punctuation">(</span>  
<span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">|</span>         <span class="token operator">&lt;</span>div <span class="token assign-left variable">title</span><span class="token operator">=</span>true<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
    <span class="token operator">|</span>                    ^
  <span class="token number">4</span> <span class="token operator">|</span>     <span class="token punctuation">)</span>
  <span class="token number">5</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">6</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p><code>JsxErrors.UnexpectedSequenceExpression</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Sequence expressions cannot be directly nested inside JSX. Did you mean to wrap it <span class="token keyword">in</span> parentheses <span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>?
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>JsxErrors.MissingClosingTagFragment</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Expected corresponding JSX closing tag <span class="token keyword">for</span> <span class="token operator">&lt;&gt;</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>JsxErrors.UnwrappedAdjacentJSXElements</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Adjacent JSX elements must be wrapped <span class="token keyword">in</span> an enclosing tag. Did you want a JSX fragment <span class="token operator">&lt;&gt;</span><span class="token punctuation">..</span>.<span class="token operator">&lt;</span>/<span class="token operator">&gt;</span>?
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  
        <span class="token operator">&lt;</span>Comp1 <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Comp2 <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SyntaxError: unknown: Adjacent JSX elements must be wrapped <span class="token keyword">in</span> an enclosing tag. Did you want a JSX fragment <span class="token operator">&lt;&gt;</span><span class="token punctuation">..</span>.<span class="token operator">&lt;</span>/<span class="token operator">&gt;</span>? <span class="token punctuation">(</span><span class="token number">4</span>:8<span class="token punctuation">)</span>

  <span class="token number">2</span> <span class="token operator">|</span>     <span class="token builtin class-name">return</span> <span class="token punctuation">(</span>  
  <span class="token number">3</span> <span class="token operator">|</span>         <span class="token operator">&lt;</span>Comp1 /<span class="token operator">&gt;</span>
<span class="token operator">&gt;</span> <span class="token number">4</span> <span class="token operator">|</span>         <span class="token operator">&lt;</span>Comp2 /<span class="token operator">&gt;</span>
    <span class="token operator">|</span>         ^
  <span class="token number">5</span> <span class="token operator">|</span>     <span class="token punctuation">)</span>
  <span class="token number">6</span> <span class="token operator">|</span> <span class="token punctuation">}</span>
  <span class="token number">7</span> <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h4 id="特定语法开关"><a href="#特定语法开关" class="header-anchor">#</a> 特定语法开关</h4> <p>Babel 并不会开启对所有语法特性的转译，这也是出于性能的考虑。</p> <p>在源码中，和&quot;语法开关&quot;相关的代码主要是文件 <code>babel/packages/babel-parser/src/parser/util.js</code> 定义的方法:</p> <ul><li><code>expectPlugin(pluginName)</code>: 检测某个插件是否被配置，如果没有会抛出错误</li> <li><code>getPluginOption()</code>: 获取插件的配置项</li></ul> <p>以下特性默认不会开启，关于每个特性的详细介绍，可查看章节&quot;Babel 内置插件&quot;了解，下表中插件名称均以源码文件命名为准。</p> <ul><li><p><code>pipelineOperator</code></p> <p>语法插件: <code>babel-plugin-syntax-pipeline-operator</code></p> <p>转换插件: <code>babel-plugin-proposal-pipeline-operator</code></p> <p>开启对 <code>pipelineOperator</code> 语法的支持，也就是 <code>|&gt;</code> 写法。</p></li> <li><p><code>throwExpressions</code></p> <p>语法插件: <code>babel-plugin-syntax-throw-expressions</code></p> <p>转换插件: <code>babel-plugin-proposal-throw-expressions</code></p> <p>开启对 <code>throwExpressions</code> 的语法支持。</p> <p>举例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span>filename <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;Argument required&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>importAssertions</code></p> <p>语法插件: <code>babel-plugin-syntax-import-assertions</code></p> <p>开启对 <code>Import assertions</code> 语法的支持。</p> <p>该语法主要是为了更清晰地描述模块的一些特性信息，比如类型。</p> <p>举个例子，引入 <code>./config.json</code> 文件时，声明其内容类型为 json，有几种写法：</p> <ul><li><p>静态 import</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> config <span class="token keyword">from</span> <span class="token string">'./config.json'</span> <span class="token keyword">assert</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'json'</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>动态 import</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./config.json'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">assert</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'json'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>export</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> config <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./config.json'</span> <span class="token keyword">assert</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'json'</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p><code>privateIn</code></p> <p>语法插件: <code>babel-plugin-syntax-private-property-in-object</code></p> <p>转换插件: <code>babel-plugin-proposal-private-property-in-object</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    #bar <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>

    <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> #bar <span class="token keyword">in</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>doExpressions</code></p> <p>语法插件: <code>babel-plugin-syntax-do-expressions</code></p> <p>转换插件: <code>babel-plugin-proposal-do-expression</code></p> <p>开启对 <code>do</code> 表达式语法的支持。<code>do</code> 表示可以认为是三元表达式的变种，在较复杂的情况下加，用 <code>do</code> 表达式更简洁。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token string">'big x, big y'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token string">'big x, small y'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token string">'small x, big y'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token string">'small x, small y'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p><code>functionSent</code></p> <p>语法插件: <code>babel-plugin-syntax-function-sent</code></p> <p>转换插件: <code>babel-plugin-proposal-function-sent</code></p> <p>开启对 <code>functionSent</code> 语法的支持，即开启对 <code>function.sent</code> 的语法支持。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Sent&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">.</span>sent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Yield&quot;</span><span class="token punctuation">,</span> <span class="token keyword">yield</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Logs &quot;Sent 1&quot;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Logs &quot;Yield 2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><code>recordAndTuple</code></p> <p>语法插件: <code>babel-plugin-syntax-record-and-tuple</code></p> <p>开启对 <code>recordAndTuple</code> 语法的支持，对应的是 <code>proposal-record-tuple</code> 提案。</p></li> <li><p><code>partialApplication</code></p> <p>语法插件: <code>babel-plugin-syntax-partial-application</code></p> <p>转换插件: <code>babel-plugin-proposal-partial-application</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">)</span>           <span class="token comment">// partial application from left</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>           <span class="token comment">// partial application from right</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">)</span>        <span class="token comment">// partial application for any arg</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><code>moduleBlocks</code></p> <p>语法插件: <code>babel-plugin-syntax-module-blocks</code></p> <p>开启对 <code>moduleBlocks</code> 语法的支持。</p> <p><code>moduleBlocks</code> 语法简介如下(案例来自tc39)：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> moduleBlock <span class="token operator">=</span> module <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> moduleExports <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>moduleBlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assert</span><span class="token punctuation">(</span>moduleExports<span class="token punctuation">.</span>y <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>moduleBlock<span class="token punctuation">)</span> <span class="token operator">===</span> moduleExports<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// cached in the module map</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这样，提供了非文件的方式引入模块。</p> <p>且 <code>moduleBlocks</code> 只能被 <code>import()</code> 引入，而非 <code>import</code> 表达式。</p></li> <li><p><code>classStaticBlock</code></p> <p>语法插件: <code>babel-plugin-syntax-class-static-block</code></p> <p>转换插件: <code>babel-plugin-proposal-class-static-block</code></p> <p>转换class类中的静态block。</p> <p>下例来自Babel官网：</p> <blockquote><p>下例的转换需要在该插件前引入插件 babel-plugin-proposal-class-properties，也就是支持对 <code>class</code> 属性的语法支持和代码转换。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> #x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> y<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token function">doSomethingWith</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token string">&quot;unknown&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p><code>classPrivateProperties</code></p> <p>语法插件: <code>babel-plugin-syntax-class-properties</code></p> <p>转换插件: <code>babel-plugin-proposal-class-properties</code></p> <p>开启对类的属性(<code>classProperties</code>)、私有属性(<code>classPrivateProperties</code>)、私有方法(<code>classPrivateMethods</code>)的语法支持。</p> <p>举例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Man</span> <span class="token punctuation">{</span>
    <span class="token comment">// 属性</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span>

    <span class="token comment">// 私有属性</span>
    <span class="token keyword">private</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>

    <span class="token comment">// 私有方法</span>
    <span class="token keyword">private</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p><code>classPrivateMethods</code></p> <p>语法插件: <code>plugin-syntax-class-properties</code></p> <p>转换插件: <code>babel-plugin-proposal-private-methods</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
   #xValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

   <span class="token keyword">get</span> <span class="token function">#x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#xValue<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">set</span> <span class="token function">#x</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>#xValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p><code>classProperties</code></p> <p>语法插件: <code>babel-plugin-syntax-class-properties</code></p> <p>转换插件: <code>babel-plugin-proposal-class-properties</code></p> <p>转换 class 中的原型和静态属性/方法。</p> <p>下例来自 Babel 官网。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Bork</span> <span class="token punctuation">{</span>
    <span class="token comment">// Property initializer syntax</span>
    instanceProperty <span class="token operator">=</span> <span class="token string">&quot;bork&quot;</span><span class="token punctuation">;</span>
    <span class="token function-variable function">boundFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instanceProperty<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Static class properties</span>
    <span class="token keyword">static</span> staticProperty <span class="token operator">=</span> <span class="token string">&quot;babelIsCool&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token function-variable function">staticFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Bork<span class="token punctuation">.</span>staticProperty<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p><code>exportDefaultFrom</code></p> <p>语法插件: <code>babel-plugin-syntax-export-default-from</code></p> <p>转换插件: <code>babel-plugin-proposal-export-default-from</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> v <span class="token keyword">from</span> <span class="token string">&quot;mod&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>moduleStringNames</code></p> <p>语法插件: <code>babel-plugin-syntax-module-string-names</code></p> <p>开启对 <code>moduleStringNames</code> 语法的支持，也就是模块别名的支持。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> hi <span class="token keyword">as</span> <span class="token string">'hello'</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hi.js'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>moduleAttributes</code></p></li> <li><p><code>decimal</code></p> <p>语法插件: <code>babel-plugin-syntax-demical</code></p></li></ul> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>TODO</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">June 2, 2022 15:23</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: antfootmail@gmail.com" class="contributor">
          hoperyy
        </span> <!----></span></div></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/books/deep-in-babel/assets/js/app.6c526340.js" defer></script><script src="/books/deep-in-babel/assets/js/vendors~layout-Layout.9baf7bd4.js" defer></script><script src="/books/deep-in-babel/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.ebefd1c7.js" defer></script><script src="/books/deep-in-babel/assets/js/page-语法分析和语义分析.23eb0004.js" defer></script><script src="/books/deep-in-babel/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.33005620.js" defer></script>
  </body>
</html>
